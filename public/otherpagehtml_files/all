function initAuthenticationFolding(){$("body").on("click",".authentication-form-foldable-action",function(n){n.preventDefault();var i=150,r=400,t=$(this).closest(".authentication-form-foldable"),u=t.children(".authentication-form-foldable-content"),f=t.children(".authentication-form-foldable-action"),e=$(".authentication-form-foldable.active"),o=$(".authentication-form-foldable.active .authentication-form-foldable-content"),s=$(".authentication-form-foldable.active .authentication-form-foldable-action");o.slideUp(r,function(){s.slideDown(i,function(){e.removeClass("active")})});f.slideUp(i,function(){u.slideDown(r,function(){t.addClass("active")})})})}function initAccordion(){$("body").on("click",".accordion-head",function(n){n.stopPropagation();var t=$(this).closest(".accordion-item");t.hasClass("default-open")&&(t.children(".accordion-body").css("display","block"),t.removeClass("default-open"));t.hasClass("open")?closeAccordion(t):openAccordion(t)})}function openAccordion(n){n.addClass("open");n.children(".accordion-body").slideDown(400)}function closeAccordion(n,t){typeof t=="undefined"&&(t=!0);n.parents(".plaza-calendar-details").length>0&&n.find(".accordion-item").length>0||(n.removeClass("open"),n.children(".accordion-body").slideUp(400,function(){t&&!n.hasClass("plaza-calendar-later")&&n.parents(".plaza-calendar-details").length<1&&n.children(".accordion-body").find(".accordion-item").removeClass("open").children(".accordion-body").css("display","none")}))}function initHeader(){var r=$(".header"),f=$(".header__mainmenuicon"),t=$(".mainmenu"),e=$(".mainmenu__close"),u=$("body"),o=$(".header__accountnamewrapper"),i=$(".accountpopup"),s=$(".header__language"),n=$(".languagepopup");$(window).scroll(throttle(function(){$(window).scrollTop()>50?r.addClass("header--small"):r.removeClass("header--small")}));f.click(function(n){n.preventDefault();t.css("display","flex");t.css("opacity",100);setTimeout(function(){t.addClass("mainmenu--visible");u.addClass("body--preventscrollingforfullsize")},18)});e.click(function(n){n.preventDefault();t.removeClass("mainmenu--visible");t.css("display","none");u.removeClass("body--preventscrollingforfullsize")});o.click(function(n){$(this).hasClass("header__accountnamewrapper--loggedin")&&(n.preventDefault(),i.hasClass("accountpopup--visible")?i.removeClass("accountpopup--visible"):i.addClass("accountpopup--visible"))});s.click(function(t){t.preventDefault();n.hasClass("languagepopup--visible")?(n.css("display","none"),n.removeClass("languagepopup--visible")):(n.css("display","block"),n.css("opacity",100),setTimeout(function(){n.addClass("languagepopup--visible")},18))})}function initFooter(){var n=$(".footer__totoplink");n.click(function(){$("html, body").animate({scrollTop:0},"slow")})}function initWebsiteFooter(){$("footer .sitemap").hide();$("footer .sitemap-opener").removeClass("open");$("footer .sitemap-opener").click(function(n){n.preventDefault();$(this).hasClass("open")?($("footer .sitemap").hide(),$("footer .sitemap-opener").removeClass("open")):($("footer .sitemap").show(),$("footer .sitemap-opener").addClass("open"))})}function throttle(n,t){var u,i,r=50;return typeof t=="number"&&(r=t),function(){var t=this,f=arguments;i?(clearTimeout(u),u=setTimeout(function(){Date.now()-i>=r&&(n.apply(t,f),i=Date.now())},r-(Date.now()-i))):(n.apply(t,f),i=Date.now())}}(function(){for(var n,u=function(){},t=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=t.length,r=window.console=window.console||{};i--;)n=t[i],r[n]||(r[n]=u)})();$(document).ready(function(){initAuthenticationFolding();initAccordion()});$(document).ready(function(){initHeader();initFooter()});$.spiritec=$.spiritec||{};$.spiritec.componentTemplateUrl=function(n){return $.spiritec.appParameters.componentBaseUrl+n+"?cacheBreaker="+$.spiritec.appParameters.cacheBreaker};$.angularLoaded={};var app=angular.module("elbphilharmonie",["ngSanitize","pascalprecht.translate"]);app.config(["$translateProvider","$sceDelegateProvider",function(n,t){n.translations("de",$.spiritec.appParameters.resourcesDe);n.translations("en",$.spiritec.appParameters.resourcesEn);n.preferredLanguage($.spiritec.appParameters.languageToken);n.useSanitizeValueStrategy("sanitizeParameters");t.resourceUrlWhitelist(["self",$.spiritec.appParameters.cdnBaseUrl+"**"])}]),function(){function n(){var n=this}angular.module("elbphilharmonie").component("addressBlock",{bindings:{address:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("addressBlock/addressBlock.html")});n.$inject=[]}(),function(){function n(n,t){function r(){return n.setAlternativeShippingAddress(i.address).then(function(){return i.serverError=null,n.loadCustomerData()}).then(function(n){i.onSubmit({customer:n})}).catch(function(){i.serverError="UNKNOWN_ERROR"})}function u(n){var t={key:null,label:f("&nbsp;")},i=n.map(function(n){return{key:n,label:n}});return[t].concat(i)}function f(n){var t=document.createElement("div");return t.innerHTML=n,t.childNodes[0].nodeValue}var i=this;i.address.country=i.address.country||"DE";i.address.title=i.address.title||null;i.submitted=!1;i.serverError=null;i.countryOptions=t.getCountryOptions();i.academicTitleOptions=u(t.getAcademicTitles());i.submit=function(){if(i.submitted=!0,i.form.$valid){var n=r();i.onProcessing({promise:n})}};i.mayEditAddress=function(){return!i.isExistingUser||i.customerData.mayEditAddress}}angular.module("elbphilharmonie").component("alternativeShippingAddressForm",{bindings:{address:"<",onSubmit:"&",onCancel:"&",onProcessing:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("alternativeShippingAddressForm/alternativeShippingAddressForm.html")});n.$inject=["customerService","appParameters"]}(),function(){function n(n,t){function r(){i.nextUrl&&(t.location.href=i.nextUrl)}var i=this;i.initialized=!1;i.processingCounter=0;i.enableLogin=typeof i.showLogin!="undefined"?i.showLogin:!0;i.enableRegister=typeof i.showRegister!="undefined"?i.showRegister:!0;i.isLoading=function(){return!i.initialized||i.processingCounter>0};n.getCustomer(!0).then(function(n){n&&r()}).finally(function(){i.initialized=!0});i.onRegister=function(){r()};i.onLogin=function(){r()};i.handleFormProcessing=function(n){i.processingCounter++;n.finally(function(){i.processingCounter--})}}angular.module("elbphilharmonie").component("authentication",{bindings:{nextUrl:"@",showLogin:"<",showRegister:"<",phoneNumberMandatory:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("authentication/authentication.html")});n.$inject=["customerService","$window"]}(),function(){function n(n,t,i,r,u,f,e){function h(){return o.serverError=null,s++,n.loadCart().then(function(n){o.cart=n}).finally(function(){s--})}function l(n){return s++,i.redeemVoucher(n).then(function(n){n.success===!1?o.serverError=n.detailedErrorCode==="VoucherCodeUnknown"?"UNKNOWN_CODE":n.detailedErrorCode==="VoucherAlreadyCashedIn"?"VOUCHER_ALREADY_CASHEDIN":n.detailedErrorCode==="VoucherCancelled"?"VOUCHER_CANCELLED":n.detailedErrorCode==="VoucherBlockedByAnotherTransaction"?"VOUCHER_BLOCKED":"UNKNOWN_ERROR":(o.serverError="",h())},function(){o.serverError="UNKNOWN_ERROR"}).finally(function(){s--})}function a(n){return s++,i.removeRedeemVoucher(n).then(function(){},function(n){o.serverError=n.errorCode===200160?"DATA_NOT_FOUND":"UNKNOWN_ERROR"}).finally(function(){h();s--})}function v(){return e(function(n,t){return Array.prototype.forEach.call(o.cart.groupedItems,function(n){Array.prototype.forEach.call(n.items,function(n){if((n.itemType==="subscription"||n.itemType==="rafflesubscription")&&!n.seatOwner.isValid)return t(6e5)})}),n()})}var o=this,s=0,c=!1;o.releaseCartTriggered=!1;o.submitted=!1;o.releaseCartAccepted=!1;o.fileBaseUrl=r.getFileBaseUrl();o.isLoading=function(){return s>0};h();o.handleCartItemChange=function(){h()};o.handleCartGroupChange=function(){h()};o.isJetTicketCartUpgradePossible=function(){return o.cart!=null&&o.cart.jetTicketUpgradePossible&&!c};o.acceptUpgrade=function(){s++;n.acceptUpgrade().then(function(){h()}).finally(function(){s--})};o.rejectUpgrade=function(){c=!0};o.handleCartItemProcessing=function(n){s++;n.finally(function(){s--})};o.handleCartGroupProcessing=function(n){s++;n.finally(function(){s--})};o.showPreviousUrl=function(){return o.cart!=null&&o.cart.items!=null&&o.cart.items.length>0&&!o.cart.isReadonly&&typeof o.previousUrl=="string"&&o.previousUrl!==""};o.saveSeatOwner=function(n,t){return new Promise(function(i,r){f.saveCartItemSeatOwner(n,t).then(function(n){n.success?(o.handleCartGroupChange(),i()):r(n.errorCode)}).catch(function(){r()})})};o.redeemVoucher=function(){o.voucherCode!==undefined&&o.voucherCode.length>0&&(l(o.voucherCode.replace(/ /g,"")),o.voucherCode="")};o.removeRedeemVoucher=function(n){a(n)};o.willCreateNewVoucher=function(){return o.cart.totalPriceAfterVoucherWithoutFees<0};o.triggerReleaseCart=function(){o.releaseCartTriggered=!0};o.cancelReleaseCart=function(){o.releaseCartTriggered=!1;o.submitted=!1};o.submit=function(){o.submitted=!0;o.releaseCartAccepted&&(s++,n.releaseCart(o.cart.id).then(function(n){n.success===!1||(h(),elbphilharmonie.WebshopApi.SetCartProductCount(0))}).finally(function(){s--}))};o.goToNextUrl=function(){o.submitted=!0;v().then(function(){u.location.href=o.nextUrl},function(n){o.serverError=n===6e5?"GENERAL_SEATOWNER_ERRORSEATOWNERMISSING":"SUBSCRIPTION_UNKNOWN_ERROR"})};o.prettyPrintVoucherInput=function(){for(var t="",i=o.voucherCode.replace(/ /g,""),n=0,r=i.length;n<r;n++)n!==0&&n%4==0&&(t+=" "),t+=i[n];o.voucherCode=t};o.onEventOrganizerClick=function(){t.scrollToContent("section.cart__eventorganizers")}}angular.module("elbphilharmonie").component("cart",{bindings:{previousUrl:"@",nextUrl:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cart/cart.html")});n.$inject=["cartService","scrollService","webshopApi","appParameters","$window","checkoutService","$q"]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartHint",{bindings:{text:"@",html:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartHint/cartHint.html")});n.$inject=[]}(),function(){function n(n,t){var i=this;i.redeemPromotionCode=function(){i.promotionCode===undefined||i.promotionCode.length<=0||n.redeemPromotionCode(i.promotionCode).then(function(){t.location.reload()}).catch(function(){i.promotionCode=""})}}angular.module("elbphilharmonie").component("cartPromotionCode",{bindings:{},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartPromotionCode/cartPromotionCode.html")});n.$inject=["cartService","$window"]}(),function(){function n(n){function i(n){n!=null&&n.length>0&&(t.reductionOptions=n.map(function(n){return{key:n.id,label:n.name}}))}var t=this;t.reductionOptionsLoaded={};t.loadingReductionOptions={};t.onRemoveItem=function(i){var r=n.removeCartItem(i);t.onProcessing({promise:r});r.then(function(){t.onChange()})};t.onLoadReductionOptions=function(r){t.reductionOptionsLoaded[r]!==!0&&t.loadingReductionOptions[r]!==!0&&(t.loadingReductionOptions[r]=!0,n.getAvailableReductions(r).then(function(n){i(n);t.reductionOptionsLoaded[r]=!0}).finally(function(){t.loadingReductionOptions[r]=!1;window.setTimeout(function(){var n=null;typeof MouseEvent!="function"?(n=document.createEvent("MouseEvent"),n.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null)):n=new MouseEvent("mousedown",{view:window,bubbles:!0,cancelable:!0});$("#reduction-select-"+r+" select").length>0&&$("#reduction-select-"+r+" select")[0].dispatchEvent(n)},0)}))};t.changeReduction=function(i,r){var u=n.updateReduction(i,r);t.onProcessing({promise:u});u.then(function(){t.onChange()})};t.onItemChanged=function(){t.onChange()};t.showDateAndVenue=function(){return t.group.dateAndTime||t.group.venueName}}angular.module("elbphilharmonie").component("cartItemGroup",{bindings:{group:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onChange:"&",editable:"<",onEventOrganizerClick:"&",submitted:"<",saveSeatOwner:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroup.html")});n.$inject=["cartService","$scope"]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartItemGroupExternalGuidedTourItem",{bindings:{externalGuidedTour:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onRemove:"&",editable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupExternalGuidedTourItem/cartItemGroupExternalGuidedTourItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartItemGroupGuidedTourItem",{bindings:{guidedTour:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onRemove:"&",onLoadReductionOptions:"&",onReductionChanged:"&",reductionOptions:"=",editable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupGuidedTourItem/cartItemGroupGuidedTourItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartItemGroupGuidedGroupTourItem",{bindings:{guidedGroupTour:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onRemove:"&",onLoadReductionOptions:"&",onReductionChanged:"&",reductionOptions:"=",editable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupGuidedGroupTourItem/cartItemGroupGuidedGroupTourItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartItemGroupVoucherItem",{bindings:{voucher:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onRemove:"&",editable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupVoucherItem/cartItemGroupVoucherItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartItemGroupTicketItem",{bindings:{ticket:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onRemove:"&",onLoadReductionOptions:"&",onReductionChanged:"&",reductionOptions:"=",editable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupTicketItem/cartItemGroupTicketItem.html")});n.$inject=[]}(),function(){function n(){var n=this;n.doSaveSeatOwner=function(t){return n.saveSeatOwner(n.subscription.id,t)}}angular.module("elbphilharmonie").component("cartItemGroupSubscriptionItem",{bindings:{subscription:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",submitted:"<",onProcessing:"&",onRemove:"&",onItemChange:"&",onLoadReductionOptions:"&",onReductionChanged:"&",reductionOptions:"=",editable:"<",saveSeatOwner:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupSubscriptionItem/cartItemGroupSubscriptionItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartItemGroupArticleItem",{bindings:{article:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onRemove:"&",editable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupArticleItem/cartItemGroupArticleItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartItemGroupPlazaGroupTicketItem",{bindings:{groupTicket:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onRemove:"&",editable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupPlazaGroupTicketItem/cartItemGroupPlazaGroupTicketItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("cartItemGroupPlazaTicketItem",{bindings:{plazaTicket:"<",enableShippingMethodSelection:"<",shippingMethodsSelectable:"<",onProcessing:"&",onRemove:"&",editable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupPlazaTicketItem/cartItemGroupPlazaTicketItem.html")});n.$inject=[]}(),function(){function n(n,t){function u(){return i.cart=null,t.loadCart().then(function(n){i.cart=n})}var i=this,r=0;i.cart=null;i.selectedShippingMethod=i.cartItem.shippingMethod;i.isLoading=function(){return r>0};i.onShippingMethodSelected=function(){r++;n.setShippingMethodForCartItem(i.selectedShippingMethod,i.cartItem).then(function(){u()});r--}}angular.module("elbphilharmonie").component("cartItemGroupShippingMethodSelection",{bindings:{cartItem:"<",shippingMethods:"<",editable:"<",shippingMethodsSelectable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("cartItemGroup/cartItemGroupShippingMethodSelection/cartItemGroupShippingMethodSelection.html")});n.$inject=["checkoutService","cartService"]}(),function(){function n(n){var t=this;t.currentStepId=["shipping","payment","summary"][0];t.customer=null;t.skipShipping={};t.skipShipping.display=!1;t.showLoader=!0;t.isLoading=function(){return t.showLoader};n.loadCustomerData().then(function(n){t.customer=n;t.showLoader=!1},function(){t.showLoader=!1})}angular.module("elbphilharmonie").component("checkout",{bindings:{guestEmailAddress:"@",allowGuestBooking:"<",allowInsurance:"<",tosText:"@",tosDetailedInformation:"@",privacyPolicyHint:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("checkout/checkout.html")});n.$inject=["customerService","scrollService"]}(),function(){function n(n,t){function r(){i.processingCounter++;t.location.href=i.nextUrl}function u(){return!1}var i=this;i.customer=null;i.initialized=!1;i.processingCounter=0;i.isLoading=function(){return!i.initialized||i.processingCounter>0};n.getCustomer(!0).then(function(n){u(n)?r():(i.customer=n,i.initialized=!0)});i.onRegister=function(){r()};i.onGuestRegistration=function(){r()};i.onCustomerDataUpdate=function(n){i.customer=n;r()};i.onLogin=function(n){u(n)?r():i.customer=n};i.handleFormProcessing=function(n){i.processingCounter++;n.finally(function(){i.processingCounter--})}}angular.module("elbphilharmonie").component("checkoutAuthentication",{bindings:{previousUrl:"@",nextUrl:"@",guestEmailAddress:"@",allowGuestBooking:"<",allowCompanyRegistration:"<",dsgvo:"@",dsgvoGuest:"@",phoneNumberMandatory:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("checkoutAuthentication/checkoutAuthentication.html")});n.$inject=["customerService","$window","scrollService"]}(),function(){function n(n,t,i){function f(n,t){if(n){var i=t.filter(function(t){return t.id===n.id});return i.length>0?i[0]:null}return t.length&&t.length===1?t[0]:null}var r=this,u=0;r.selectedMethod=null;r.shippingMethods=null;r.cart=null;r.submitted=!1;r.editingAlternativeShippingAddress=!1;r.alternativeShippingAddress=null;r.shippingAddressChoice="default";r.anyOnlineDelivery=!1;r.isLoading=function(){return u>0};i.all([t.loadCart(),n.getShippingMethods()]).then(function(n){var t,i;for(r.cart=n[0],r.shippingMethods=n[1],r.anyOnlineDelivery=!1,t=0;t<r.shippingMethods.length;t++)if(i=r.shippingMethods[t].type,typeof i=="string"&&i.toLowerCase()==="online"){r.anyOnlineDelivery=!0;break}if(r.selectedMethod=f(r.cart.defaultShippingMethod,r.shippingMethods),r.shippingAddressChoice=r.cart.useAlternativeShippingAddress?"alternative":"default",r.shippingAddressChoice="default",r.cart.hasSeatSponsorshipItems&&!r.cart.hasOtherItems){r.selectedMethod=r.shippingMethods[0];r.submit();return}!r.cart.defaultShippingMethod&&r.shippingMethods.length===1&&r.anyOnlineDelivery&&r.submit()});r.editAlternativeShippingAddress=function(){var n=r.customer.shippingAddress||r.customer;r.alternativeShippingAddress=angular.extend({},n);r.editingAlternativeShippingAddress=!0};r.cancelEditingAlternativeShippingAddress=function(){r.editingAlternativeShippingAddress=!1};r.handleNewAlternativeShippingAddress=function(n){r.customer=n;r.editingAlternativeShippingAddress=!1;r.shippingAddressChoice="alternative";r.shippingAddressChoice="default"};r.showCompanyName=function(){return r.customer!=null&&r.customer.type!=="privateCustomer"};r.handleFormProcessing=function(n){u++;n.finally(function(){u--})};r.submit=function(){if(r.submitted=!0,r.form.$valid){var t=r.shippingAddressChoice==="alternative",i=n.setShippingMethod(r.selectedMethod,t).then(function(n){n.maySkipPaymentMethodSelection?(r.onSkipShippingBool.display=!0,r.onGoToSummary()):n.skipShippingMethodDetailSelection?(r.onSkipShippingBool.display=!1,r.onSkipShipping()):(r.onSkipShippingBool.display=!0,r.onSuccess())});r.handleFormProcessing(i)}}}angular.module("elbphilharmonie").component("checkoutShippingMethod",{bindings:{onSuccess:"&",onGoToSummary:"&",customer:"<",onSkipShipping:"&",onSkipShippingBool:"<",guestEmailAddress:"<",allowGuestBooking:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("checkoutShippingMethod/checkoutShippingMethod.html")});n.$inject=["checkoutService","cartService","$q"]}(),function(){function n(n,t){function u(){return r++,n.loadCart().then(function(n){i.cart=n}).finally(function(){r--})}var i=this,r=0;i.isLoading=function(){return r>0};u();i.submit=function(){i.submitted=!0;i.onSuccess()};i.handleCartGroupProcessing=function(n){r++;n.finally(function(){r--})};i.handleCartGroupChange=function(){u()};i.saveSeatOwner=function(n,t){return new Promise(function(r,u){checkoutService.saveCartItemSeatOwner(n,t).then(function(n){n.success?(i.handleCartGroupChange(),r()):u(n.errorCode)}).catch(function(){u()})})};i.onEventOrganizerClick=function(){t.scrollToContent("section.cart__eventorganizers")}}angular.module("elbphilharmonie").component("checkoutShippingMethodInvalid",{bindings:{onSuccess:"&",onGoToSummary:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("checkoutShippingMethod/checkoutShippingMethodInvalid.html")});n.$inject=["cartService","scrollService"]}(),function(){function n(n){var t=this,i={id:t.stepId,index:parseInt(t.stepIndex),name:t.name,inProgressIndicator:t.inProgressIndicator!==!1};t.hasOwnProperty("heading")&&(i.heading=t.heading);t.isVisible=function(){return t.stepsController.currentStep===i};n.$watch(function(){return t.inProgressIndicator},function(n,r){n!==r&&(i.inProgressIndicator=t.inProgressIndicator!==!1)});this.$onInit=function(){t.stepsController.registerStep(i)}}angular.module("elbphilharmonie").component("checkoutStep",{bindings:{name:"@",stepId:"@",stepIndex:"@",heading:"@",inProgressIndicator:"<"},transclude:!0,controller:n,require:{stepsController:"^^checkoutSteps"},templateUrl:$.spiritec.componentTemplateUrl("checkoutSteps/checkoutStep.html")});n.$inject=["$scope"]}(),function(){function n(n,t){function f(n,t){for(var i=0;t.length>i&&t[i].index<n.index;)i++;t.splice(i,0,n)}function e(n){var t=i.steps.filter(function(t){return n==="/"+t.id});i.currentStep=t.shift()||i.steps[0]}function r(){}var i=this,u=null;i.steps=[];i.currentStep=null;i.stepNames=Array("1","1b","2","3");i.registerStep=function(n){f(n,i.steps);i.steps.length===1?i.currentStep=i.steps[0]:n.id===u&&(i.currentStep=n)};i.proceed=function(){var n=i.steps.indexOf(i.currentStep)+1;n<i.steps.length&&(i.jumpTo(i.steps[n]),r())};i.proceedTwo=function(){var n=i.steps.indexOf(i.currentStep)+2;n<i.steps.length&&(i.jumpTo(i.steps[n]),r())};i.proceedToLast=function(){i.jumpTo(i.steps[i.steps.length-1]);r()};n.$on("checkout-step-completed",function(){i.proceed()});n.$on("checkout-skip-shipping-detail",function(){i.proceedTwo()});n.$on("checkout-go-to-summary",function(){i.proceedToLast()});i.jumpTo=function(n){t.path("/"+n.id)};i.isVisited=function(n){return i.steps.indexOf(n)<i.steps.indexOf(i.currentStep)};i.isCurrent=function(n){return i.steps.indexOf(n)===i.steps.indexOf(i.currentStep)};i.isDisabled=function(){return!1};n.$watch(function(){return t.path()},function(n){i.steps.length>0?e(n):u=n?n.substring(1):null})}angular.module("elbphilharmonie").component("checkoutSteps",{bindings:{},controller:n,transclude:!0,templateUrl:$.spiritec.componentTemplateUrl("checkoutSteps/checkoutSteps.html")});n.$inject=["$scope","$location","appParameters"]}(),function(){function n(n,t,i){function u(n,t){if(n){var i=t.filter(function(t){return t.id===n.id});return i.length>0?i[0]:null}return null}var r=this;r.selectedMethod=null;r.paymentMethods=null;r.cart=null;r.submitted=!1;i.all([t.loadCart(),n.getPaymentMethods()]).then(function(n){r.cart=n[0];r.paymentMethods=n[1];r.selectedMethod=u(r.cart.paymentMethod,r.paymentMethods);r.selectedMethod==null&&r.cart.totalPriceAfterVoucher<=0&&(r.selectedMethod=r.paymentMethods[0],r.submit())});r.submit=function(){r.submitted=!0;r.form.$valid&&n.setPaymentMethod(r.selectedMethod).then(function(){r.onSuccess()})}}angular.module("elbphilharmonie").component("checkoutPaymentMethod",{bindings:{onSuccess:"&",customer:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("checkoutPaymentMethod/checkoutPaymentMethod.html")});n.$inject=["checkoutService","cartService","$q"]}(),function(){function n(n,t,i,r,u,f,e,o){function v(){h++;s.serverError=null;n.startPayment(s.cart.totalPrice,s.subscribeToNewsletter).then(function(n){n.initializeAmazonPayCheckout?u.initializeAmazonPayCheckout(n.url,n.paymentRequestId).catch(function(){s.showAmazonPayError=!0;o.$apply()}):window.location.href=n.url}).catch(function(n){n.errorCode===200102?(s.serverError="CART_HAS_CHANGED",a()):n.errorCode===200103?s.serverError="CUSTOMER_INPUT_OR_SESSION_FAILED":n.errorCode===200104?s.serverError="PAYMENT_INITIALIZATION_FAILED":n.errorCode===200028?s.serverError="PHONENUMBER_IS_MISSING":n.errorCode===200105?s.serverError="MAXIMUM_TICKET_LIMIT_PER_ACCOUNT_REACHED":n.errorCode===200106?s.serverError="MAXIMUM_TICKET_LIMIT_PER_ADVANCED_BOOKING_REACHED":n.errorCode===200107?s.serverError="MAXIMUM_PLAZATICKET_LIMIT_PER_ACCOUNTTIMESLOT_REACHED":n.errorCode===200108?s.serverError="ORDER_ALREADY_BOOKED":n.errorCode===200109?s.serverError="CART_INVALID":n.errorCode===2001091?s.serverError="CART_TIMEOUT":n.errorCode===5e5?s.serverError="MAXIMUM_TICKET_LIMIT_PER_CHEAT_LINK_REACHED":n.errorCode===500001?s.serverError="CHEAT_LINK_ALREADY_USED":n.errorCode===500002?(s.serverError="CHEAT_LINK_NOT_YET_VALID",s.serverErrorDate=n.errorFields.date,s.serverErrorTime=n.errorFields.time):n.errorCode===500003?(s.serverError="CHEAT_LINK_NO_LONGER_VALID",s.serverErrorDate=n.errorFields.date,s.serverErrorTime=n.errorFields.time):s.serverError="UNKNOWN_ERROR";h--}).finally(function(){s.submitInProgress=!1})}function a(){return s.cart=null,i.synchronizeCart().finally(function(){c()})}function c(){return s.cart=null,i.loadCart().then(function(n){s.cart=n})}var s=this,h=0,l=!1;s.cart=null;s.fileBaseUrl=f.getFileBaseUrl();s.showLoading=!1;s.tosAccepted=!1;s.submitted=!1;s.submitInProgress=!1;s.showAmazonPayError=!1;s.serverError=null;s.serverErrorDate=null;s.serverErrorTime=null;s.subscribeToNewsletter=!1;s.canSubscribeToNewsletter=!1;s.initialized=!1;a();r.canSubscribeToNewsletter("Checkout").then(function(n){s.canSubscribeToNewsletter=n}).finally(function(){s.initialized=!0;o.$apply()});s.isLoading=function(){return!s.initialized||h>0};s.cartIsLoaded=function(){return s.cart!=null};s.isAmazonPay=function(){return s.cartIsLoaded()&&s.cart.totalPriceAfterVoucher>0&&s.cart.paymentMethod.type===5};s.isJetTicketCartUpgradePossible=function(){return s.cart!=null&&s.cart.jetTicketUpgradePossible&&!l};s.submit=function(){s.submitted=!0;s.showAmazonPayError=!1;s.form.$valid&&s.cart!=null&&!s.submitInProgress&&(s.submitInProgress=!0,v())};s.acceptUpgrade=function(){h++;var n=i.acceptUpgrade();n.then(function(){c()});n.finally(function(){h--})};s.rejectUpgrade=function(){l=!0};s.reloadCart=function(){c()};s.showCompanyName=function(){return s.customer!=null&&s.customer.type!=="privateCustomer"};s.willCreateNewVoucher=function(){return s.cart.totalPriceAfterVoucher<0};s.handleCartGroupProcessing=function(n){h++;n.finally(function(){h--})};s.handleCartGroupChange=function(){c()};s.saveSeatOwner=function(t,i){return new Promise(function(r,u){n.saveCartItemSeatOwner(t,i).then(function(n){n.success?(s.handleCartGroupChange(),r()):u(n.errorCode)}).catch(function(){u()})})};s.onEventOrganizerClick=function(){t.scrollToContent("section.cart__eventorganizers")}}angular.module("elbphilharmonie").component("checkoutSummary",{bindings:{customer:"<",guestEmailAddress:"<",allowGuestBooking:"<",tosText:"@",tosDetailedInformation:"@",privacyPolicyHint:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("checkoutSummary/checkoutSummary.html")});n.$inject=["checkoutService","scrollService","cartService","newsletterService","amazonPayService","appParameters","$filter","$scope"]}(),function(){function n(n,t){function r(){n.processSeatSponsorship(i.orderId,null,i.paymentRequest).then(function(n){n.status==="pending"?t(function(){r()},2e3):n.status==="completed"&&typeof n.redirectUrl=="string"?window.location.href=n.redirectUrl:i.processSeatSponsorshipFinished=!0}).catch(function(){i.processSeatSponsorshipFinished=!0})}var i=this;i.orderDate=new Date(i.orderDateString);i._ticketOverviewLoaded=!1;i._initTimestamp=(new Date).getTime();i.showTicketErrorNotification=function(){var n=(new Date).getTime(),t=Math.floor((n-i._initTimestamp)/1e3);return!i._ticketOverviewLoaded&&t>60};i.ticketOverviewLoaded=function(){i._ticketOverviewLoaded=!0};i.processSeatSponsorshipFinished=!1;r()}angular.module("elbphilharmonie").component("confirmation",{bindings:{orderId:"<",paymentRequest:"@",orderDateString:"@",homeLink:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("confirmation/confirmation.html")});n.$inject=["orderService","$timeout","dateUtils","scrollService"]}(),function(){function n(n){var t=this;t.success=!1;t.submit=function(){if(t.submitted=!0,t.form.$valid){var i=n.addContactOptIn(t.token,t.confirmationText).then(function(n){n.success?t.success=!0:t.serverError=n.error});t.onProcessing({promise:i})}}}angular.module("elbphilharmonie").component("contactOptIn",{bindings:{token:"@",tokenInvalid:"<",tokenAlreadyVerified:"<",confirmationInfo:"@",confirmationText:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("contactOptIn/contactOptIn.html")});n.$inject=["webshopApi"]}(),function(){function n(n){var t=this;t.countryNames={};n.getCountryOptions().forEach(function(n){t.countryNames[n.key]=n.label});t.showCompanyName=function(){return t.customer!=null&&t.customer.type!=="privateCustomer"}}angular.module("elbphilharmonie").component("customerData",{bindings:{customer:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("customerData/customerData.html")});n.$inject=["appParameters"]}(),function(){function n(n,t,i,r){function f(){return n.updateCustomerData(u.customerData,u.phoneNumberMandatory).then(function(){return u.serverError=null,n.loadCustomerData()}).then(function(n){u.onSubmit({customer:n})}).catch(function(n){u.serverError=n.errorCode===200025?"USER_NOT_UNIQUE_IN_JETTICKET":n.errorCode===200026?"EMAIL_NOT_ACTIVATED":n.errorCode===200028?"PHONE_INVALID":"UNKNOWN_ERROR"})}function e(){return n.register(u.customerData,u.phoneNumberMandatory).then(function(n){u.serverError=null;u.onSubmit({customer:n})}).catch(function(n){u.processRegistrationError(n)})}function o(){return u.customRegistrationHandler(u.customerData).then(function(n){u.serverError=null;u.onSubmit({customer:n})}).catch(function(n){u.processRegistrationError(n)})}function s(n){var t={key:null,label:h("&nbsp;")},i=n.map(function(n){return{key:n,label:n}});return[t].concat(i)}function h(n){var t=document.createElement("div");return t.innerHTML=n,t.childNodes[0].nodeValue}var u=this;u.isExistingUser=u.customer?!0:!1;u.customerData=u.isExistingUser?$.extend({},u.customer):{};u.customerData.country=u.customerData.country||"DE";u.customerData.title=u.customerData.title||null;u.submitted=!1;u.serverError=null;u.waitingForEmailActivation=!1;u.countryOptions=t.getCountryOptions();u.academicTitleOptions=s(t.getAcademicTitles());u.phonePattern=/^[0-9 \)\(\+\-]*$/;u.enableEMailRepetition=t.getEMailRepetition();u.updateUI=function(){r(function(){i.$apply()})};u.setPostalCodeRegEx=function(){typeof u.customerData=="undefined"&&(u.postalCodeRegex="");var n=t.getPostalCodeRegEx();u.postalCodeRegex=n[u.customerData.country]};u.setPostalCodeRegEx();u.submit=function(){if(u.submitted=!0,u.customerDataForm.$valid){var n=u.customRegistrationHandler?o():u.isExistingUser?f():e();u.onProcessing({promise:n})}};u.mayEditAddress=function(){return!u.isExistingUser||u.customerData.type==="writeableCompanyCustomer"||u.customerData.type==="privateCustomer"};u.showCompanyName=function(){return u.isExistingUser&&u.customerData.type!=="privateCustomer"||!u.isExistingUser&&u.allowCompanyRegistration};u.mayEditCompanyName=function(){return u.isExistingUser&&u.customerData.type==="writeableCompanyCustomer"||!u.isExistingUser&&u.allowCompanyRegistration};u.showCompanyHint=function(){return u.customerData.type==="readonlyCompanyCustomer"||u.customerData.type==="company"};u.resetPasswordUrl=t.getResetPasswortUrl();u.processRegistrationError=function(n){n.errorCode===200023?u.serverError="PASSWORD_TOO_WEAK":n.errorCode===200021?u.serverError="EMAIL_ALREADY_TAKEN":n.errorCode===200025?(u.serverError="USER_NOT_UNIQUE_IN_JETTICKET",u.isExistingUser=!0):n.errorCode===200026?(u.isExistingUser=!0,u.waitingForEmailActivation=!0):u.serverError="UNKNOWN_ERROR";u.updateUI()}}angular.module("elbphilharmonie").component("customerDataForm",{bindings:{customer:"<",onSubmit:"&",onCancel:"&?",onProcessing:"&",allowCompanyRegistration:"<",submitButtonLabel:"@",dsgvo:"@",emailIsReadOnly:"<",phoneNumberMandatory:"<",customRegistrationHandler:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("customerDataForm/customerDataForm.html")});n.$inject=["customerService","appParameters","$scope","$timeout"]}(),function(){function n(n){function i(){return n.setGuestEmailAddress(t.email).then(function(n){t.serverError=null;t.onSubmit({email:n})}).catch(function(){t.serverError="UNKNOWN_ERROR"})}var t=this;t.submitted=!1;t.serverError=null;t.submit=function(){if(t.submitted=!0,t.guestRegistrationForm.$valid){var n=i();t.onProcessing({promise:n})}}}angular.module("elbphilharmonie").component("guestRegistrationForm",{bindings:{email:"@",onSubmit:"&",onProcessing:"&",dsgvo:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("guestRegistrationForm/guestRegistrationForm.html")});n.$inject=["guestRegistrationService"]}(),function(){function n(n,t){function r(){return i.serverError=null,n.login(i.email,i.password,!0).then(function(n){i.onLogin({customer:n})},function(n){i.serverError=n.errorCode===200002?"WRONG_LOGIN_DATA":n.errorCode===200004?"CORPORATE_CUSTOMER":"UNKNOWN_ERROR"})}var i=this;i.submitted=!1;i.facebookSubmitted=!1;i.email="";i.password="";i.serverError=null;i.submit=function(){if(i.submitted=!0,i.loginForm.$valid){var n=r();i.onProcessing({promise:n})}};i.resetPasswordUrl=t.getResetPasswortUrl()}angular.module("elbphilharmonie").component("loginForm",{bindings:{onSubmit:"&",onLogin:"&",onProcessing:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("loginForm/loginForm.html")});n.$inject=["customerService","appParameters","loggingService"]}(),function(){function n(n,t,i){function e(){return n.getArticle(r.articleId).then(function(n){r.article=n;r.article.Contingents.length===1&&(r.selectedContingent=r.article.Contingents[0].Id);r.displayForm=!0},function(n){r.serverError=n.errorCode===200160?"DATA_NOT_FOUND":"UNKNOWN_ERROR"}).finally(function(){u=!1})}var r=this,u,f;r.article=null;u=!0;r.submitted=!1;r.serverError="";r.displayForm=!1;r.isLoading=function(){return u};f=e();r.onProcessing({promise:f});r.generateTicketCount=function(n){var i=[],t;for(n>10&&(n=10),t=1;t<=n;t++)i[t-1]=t;return i};r.addArticleToCart=function(t,u,f){var e=n.addArticleToCart(t,u,f).then(function(n){n.success===!1?r.serverError=n.detailedErrorCode.indexOf("ContigentDepleted")!==-1?"CONTINGENT_DEPLETED":n.detailedErrorCode.indexOf("DataNotFound")!==-1?"DATA_NOT_FOUND":"UNKNOWN_ERROR":(r.serverError="",i.location.href=r.cartUrl)});r.onProcessing({promise:e})};r.submit=function(){r.submitted=!0;r.form.$valid&&r.addArticleToCart(r.article.Id,r.selectedContingent,r.selectedContingentCount)};r.onChangeContingent=function(){r.submitted=!1;r.serverError=""};r.getImageFromSelectedContingent=function(){if(r.article==null)return null;for(var n=0;n<r.article.Contingents.length;n++)if(r.article.Contingents[n].Id==r.selectedContingent)return r.article.Contingents[n].ImageFileLink;return null}}angular.module("elbphilharmonie").component("article",{bindings:{onProcessing:"&",articleId:"<",cartUrl:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("article/article.html")});n.$inject=["webshopApi","scrollService","$window"]}(),function(){function n(n,t){var i=this;i.submitted=!1;i.serverError=null;i.success=!1;i.tokenValidOnInit=!0;i.checkToken=function(){n.resetPassword(i.resetToken,"",0).then(function(){}).catch(function(n){n.errorCode===200034&&(i.serverError="INVALID_TOKEN",i.tokenValidOnInit=!1)})};i.submit=function(){i.submitted=!0;i.form.$valid&&!i.localError()&&(i.serverError=null,n.resetPassword(i.resetToken,i.password1,1).then(function(){t.logInfo(1,"Statuscode: 0 - Info\r\nDas Passwort wurde erfolgreich zurückgesetzt.\r\n");i.success=!0}).catch(function(n){var r="";n.errorCode===200034?(i.serverError="INVALID_TOKEN",r="Ungültiger Token"):n.errorCode===200023?(i.serverError="PASSWORD_TOO_WEAK",r="unzureichende Passwortstärke"):(i.serverError="UNKNOWN_ERROR",r="Unbekannter Fehler");t.logError(1,"Statuscode: 2 - Fehler\r\nBeim Passwort zurücksetzen ist ein Fehler aufgetreten.\r\nFehlercode: "+n.errorCode+" | "+r)}))};i.localError=function(){return i.password1&&i.password2&&i.password1!==i.password2?"PASSWORDS_DO_NOT_MATCH":null}}angular.module("elbphilharmonie").component("passwordResetForm",{bindings:{resetToken:"<",loginUrl:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("passwordResetForm/passwordResetForm.html")});n.$inject=["webshopApi","loggingService"]}(),function(){function n(n,t,i){var r=this,u;r.submitted=!1;r.success=!1;r.serverError=null;u=null;t.getLanguage().then(function(n){u=n});r.isLoading=function(){return u==null};r.submit=function(){r.submitted=!0;r.form.$valid&&(r.serverError=null,n.requestPasswordReset(r.email,u).then(function(){i.logInfo(1,"Statuscode: 0 - Info\r\nPasswort zurücksetzen wurde aufgerufen.\r\nE-Mail: "+r.email);r.success=!0}).catch(function(n){n.errorCode===200025?(r.serverError="AMBIGUOUSEMAIL_ERROR",i.logError(1,"Statuscode: 2 - Fehler\r\nUnter dieser E-Mail-Adresse gibt es mehrere Kunden in jetticket.\r\nE-Mail: "+r.email)):(r.serverError="UNKNOWN_ERROR",i.logError(1,"Statuscode: 2 - Fehler\r\nBeim Passwort zurücksetzen ist ein unbekannter Fehler aufgetreten.\r\nE-Mail: "+r.email))}))}}angular.module("elbphilharmonie").component("passwordResetRequestForm",{bindings:{previousUrl:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("passwordResetRequestForm/passwordResetRequestForm.html")});n.$inject=["webshopApi","customerService","loggingService"]}(),function(){function n(n,t,i,r,u,f){var e=this;e.showLoading=!0;e.showWallet=!0;e.mayProceedWithPayment=!1;e.serverError=null;e.errorCodeNumber=0;typeof e.errorCode=="string"&&e.errorCode!==""&&(e.errorCodeNumber=parseInt(e.errorCode));e.isLoading=function(){return e.showLoading};e.updateUI=function(){t(function(){u.$apply()})};f.$on("amazonPaySuccessfullyInitialized",function(){e.mayProceedWithPayment=!0;e.updateUI()});e.initialize=function(){if(e.errorCodeNumber>0&&e.handleError(e.errorCodeNumber),!e.showWallet){e.showLoading=!1;return}r.initializeAmazonPayWallet().then(function(){e.showLoading=!1;e.updateUI()})};e.showPayNowButton=function(){return e.mayProceedWithPayment};e.proceedCheckout=function(){e.serverError=null;e.showLoading=!0;r.startConfirmationFlow().then(function(){}).catch(function(n){e.handleError(n.errorCode);e.showLoading=!1;e.updateUI()})};e.handleError=function(n){n===200110||n===200114||n===200117?e.serverError="INVALIDPAYMENTMETHOD_ERROR":n===200115?e.serverError="PAYMENTPLANNOTSET_ERROR":(e.serverError="UNKNOWN_ERROR",e.showWallet=!1,e.mayProceedWithPayment=!1)};e.changePaymentMethod=function(){e.showLoading=!0;r.cancel().then(function(){window.location.href=e.selectPaymentUrl}).finally(function(){e.showLoading=!1})};t(function(){e.initialize()})}angular.module("elbphilharmonie").component("amazonPay",{bindings:{selectPaymentUrl:"@",errorCode:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("payment/amazonPay/amazonPay.html")});n.$inject=["paymentService","$timeout","scrollService","amazonPayService","$scope","$rootScope"]}(),function(){function n(n,t,i,r){var u=this;u.showLoading=!0;u.showErrorMessage=!1;u.errorMessage="";u.showCreditCardForm=!0;u.initializationComplete=!1;u.doShowPayNowButton=!0;u.doShowTryAgainButton=!1;u.isLoading=function(){return u.showLoading};u.showPayNowButton=function(){return u.initializationComplete&&u.doShowPayNowButton};u.showTryAgainButton=function(){return u.doShowTryAgainButton};u.initializePayment=function(){u.initialErrormessage!==""?u.setErrorMessage(u.initialErrormessage):(t(function(){u.checkForCompleteInitialization()},5e3),u.startCreditCard())};u.setErrorMessage=function(n){n!=null&&(u.errorMessage=n);u.showLoading=!1;u.showErrorMessage=!0;u.showCreditCardForm=!1;t(function(){i.$apply()})};u.startCreditCard=function(){var n=$.spiritec.ccRequestData;window.WirecardPaymentPage.seamlessRenderForm({requestData:n,wrappingDivId:"creditcardDiv",onSuccess:u.creditCardInitializationSuccess,onError:u.creditCardInitializationError})};u.creditCardInitializationSuccess=function(){u.initializationComplete=!0;u.showErrorMessage=!1;u.showLoading=!1;i.$apply()};u.creditCardInitializationError=function(t){n.handleCreditCardInitalisationError(JSON.stringify(t)).then(function(n){n.status==="reInitialized"?window.location.href=n.redirectUrl:u.setErrorMessage(null)}).catch(function(){u.setErrorMessage(null)})};u.checkForCompleteInitialization=function(){u.initializationComplete||r("CHECKOUT_PAYMENTERRORS_ERRORCREDITCARDINITIALIZATION").then(function(n){u.setErrorMessage(n)},function(){u.setErrorMessage(null)})};u.creditCardResponse=function(t,f){i.$apply(function(){if(t.form_validation_result==="failed"){u.showLoading=!1;return}n.commitCreditCardPayment(u.paymentRequestId,JSON.stringify(t),f).then(function(n){n.success||(u.doShowTryAgainButton=!0,u.doShowPayNowButton=!1,r("CHECKOUT_PAYMENTERRORS_ERROR"+t.errorCode).then(function(n){u.setErrorMessage(n)},function(){r("CHECKOUT_PAYMENTERRORS_ERROR").then(function(n){u.setErrorMessage(n)})}));typeof n.redirectUrl=="string"&&n.redirectUrl.length>5&&(window.location.href=n.redirectUrl)}).catch(function(){u.doShowTryAgainButton=!0;u.doShowPayNowButton=!1;r("CHECKOUT_PAYMENTERRORS_ERROR").then(function(n){u.setErrorMessage(n)})})})};u.creditCardResponseSuccess=function(n){if(typeof n=="object"&&n!=null&&typeof n.acs_url=="string"&&typeof n.pareq=="string"&&typeof n.transaction_id=="string"&&typeof n.merchant_account_id=="string"&&typeof n.nonce3d=="string"&&n.nonce3d!==""){var t=u.creditCard3DSecureTerminalUrl;t[t.length-1]!=="/"&&(t+="/");t+=n.transaction_id+"/";u.perform3DSecureRedirect(n.acs_url,n.pareq,t,n.merchant_account_id,n.nonce3d);return}u.creditCardResponse(n,!0)};u.creditCardResponseError=function(n){u.creditCardResponse(n,!1)};u.sendCreditCard=function(){u.showLoading=!0;window.WirecardPaymentPage.seamlessSubmitForm({onSuccess:u.creditCardResponseSuccess,onError:u.creditCardResponseError})};u.perform3DSecureRedirect=function(n,t,i,r,u){var f='<form action="'+n+'" method="post" enctype="application/x-www-form-urlencoded" id="acsform">';f=f+'<input type="hidden" name="PaReq" value="'+t+'"/>';f=f+'<input type="hidden" name="TermUrl" value="'+i+'"/>';f=f+'<input type="hidden" name="MD" value="merchant_account_id='+r+"&transaction_type=purchase&nonce3d="+u+'"/>';f=f+"<\/form>";$("body").append(f);$("#acsform").submit()};u.changePaymentMethod=function(){window.location.href=u.selectPaymentUrl};u.tryAgain=function(){window.location.reload(!0)};t(function(){u.initializePayment()})}angular.module("elbphilharmonie").component("wireCard",{bindings:{selectPaymentUrl:"@",creditCard3DSecureTerminalUrl:"@",isCreditcardPayment:"@",initialErrormessage:"@",paymentRequestId:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("payment/wireCard/wireCard.html")});n.$inject=["paymentService","$timeout","$scope","$translate","scrollService"]}(),function(){function n(n,t,i,r){var u=this,f;u.showLoading=!0;u.showErrorMessage=!1;u.errorMessage="";u.showCreditCardForm=!0;u.initializationComplete=!1;u.doShowPayNowButton=!0;u.doShowTryAgainButton=!1;u.isValid=!1;u.isLoading=function(){return u.showLoading};u.showPayNowButton=function(){return u.initializationComplete&&u.doShowPayNowButton};u.showTryAgainButton=function(){return u.doShowTryAgainButton};u.initializePayment=function(){u.initialErrormessage!==""?u.setErrorMessage(u.initialErrormessage):(t(function(){u.checkForCompleteInitialization()},5e3),u.startCreditCard())};f=null;u.initCallback=function(n,t){u.initializationComplete=!0;u.showErrorMessage=!1;u.showLoading=!1;f=t;i.$apply()};u.resultCallback=function(n,t){u.creditCardResponse(t,n==null)};u.setErrorMessage=function(n){n!=null&&(u.errorMessage=n);u.showLoading=!1;u.showErrorMessage=!0;u.showCreditCardForm=!1;t(function(){i.$apply()})};u.startCreditCard=function(){var n={language:"de",layout:"",customStyleId:null,hidePayButton:!0,hideTitleIcons:!0,skipFinalResultView:!0,products:["creditcard"],optionalFields:{autoResizeHeight:!0,creditCard:{cardHolder:!0}}};n.initCallback=u.initCallback;window.PayEngineWidget.initAsInlineComponentPi("creditcardDivConcardis",u.merchantId,n,u.resultCallback)};u.creditCardInitializationSuccess=function(){u.initializationComplete=!0;u.showErrorMessage=!1;u.showLoading=!1;i.$apply()};u.creditCardInitializationError=function(t){n.handleCreditCardInitalisationError(JSON.stringify(t)).then(function(n){n.status==="reInitialized"?window.location.href=n.redirectUrl:u.setErrorMessage(null)}).catch(function(){u.setErrorMessage(null)})};u.checkForCompleteInitialization=function(){u.initializationComplete||r("CHECKOUT_PAYMENTERRORS_ERRORCREDITCARDINITIALIZATION").then(function(n){u.setErrorMessage(n)},function(){u.setErrorMessage(null)})};u.creditCardResponse=function(t,f){i.$apply(function(){if(!f){u.showLoading=!1;return}n.commitCreditCardPayment(u.paymentRequestId,JSON.stringify(t),f).then(function(n){n.success||(u.doShowTryAgainButton=!0,u.doShowPayNowButton=!1,r("CHECKOUT_PAYMENTERRORS_ERROR"+t.errorCode).then(function(n){u.setErrorMessage(n)},function(){r("CHECKOUT_PAYMENTERRORS_ERROR").then(function(n){u.setErrorMessage(n)})}));typeof n.redirectUrl=="string"&&n.redirectUrl.length>5&&(window.location.href=n.redirectUrl)}).catch(function(){u.doShowTryAgainButton=!0;u.doShowPayNowButton=!1;r("CHECKOUT_PAYMENTERRORS_ERROR").then(function(n){u.setErrorMessage(n)})})})};u.sendCreditCard=function(){function n(n){function e(){t()}var r=n===null||typeof n=="object"&&n.cardNumber&&n.expiry&&n.verification,t=function(){setTimeout(function(){i.$apply(function(){u.showLoading=!1})},1e3)};if(!r){t();return}window.PayEngineWidget.pay(f,e)}u.showLoading=!0;window.PayEngineWidget.validate(f,n)};u.changePaymentMethod=function(){window.location.href=u.selectPaymentUrl};u.tryAgain=function(){window.location.reload(!0)};t(function(){u.initializePayment()})}angular.module("elbphilharmonie").component("concardis",{bindings:{selectPaymentUrl:"@",initialErrormessage:"@",paymentRequestId:"@",merchantId:"@",paymentButtonLabel:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("payment/concardis/concardis.html")});n.$inject=["paymentService","$timeout","$scope","$translate","scrollService"]}(),function(){function n(){var n=this;n.goToCartClick=function(){window.location.href=n.nextUrl}}angular.module("elbphilharmonie").component("paymentError",{bindings:{nextUrl:"@",errorMessage:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("payment/paymenterror.html")});n.$inject=["paymentService","$timeout","$scope"]}(),function(){function n(){var n=this;n.isResetRequest=function(){return!n.resetToken};n.isReset=function(){return!!n.resetToken}}angular.module("elbphilharmonie").component("resetPassword",{bindings:{resetToken:"@",previousUrl:"@",loginUrl:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("resetPassword/resetPassword.html")});n.$inject=["scrollService"]}(),function(){function n(n,t,i){var r=this;r.serverError=null;r.editMode=!r.seatOwner;r.gender=r.seatOwner.gender;r.firstName=r.seatOwner.firstName;r.lastName=r.seatOwner.lastName;r.isProcessingRequest=!1;r.idBase=i.getId();r.updateUI=function(){n(function(){t.$apply()})};r.toggleEditMode=function(){r.editMode=!r.editMode};r.setSeatOwner=function(){r.gender!==""&&(r.seatOwner.gender=r.gender);r.seatOwner.firstName=r.firstName;r.seatOwner.lastName=r.lastName};r.ownerDetailsAvailable=function(){return typeof r.seatOwner.firstName=="string"&&typeof r.seatOwner.lastName=="string"&&r.seatOwner.firstName!==""&&r.seatOwner.lastName!==""};r.loadOwnerFromModel=function(){r.gender=r.seatOwner.gender?r.seatOwner.gender:"";r.firstName=r.seatOwner.firstName?r.seatOwner.firstName:"";r.lastName=r.seatOwner.lastName?r.seatOwner.lastName:""};r.cancelOwnerForm=function(){r.loadOwnerFromModel();r.editMode=!1};r.submitOwnerForm=function(){r.setSeatOwner();r.isProcessingRequest=!0;r.saveSeatOwner(r.seatOwner).then(function(){r.editMode=!1;r.seatOwner.isValid=!0}).catch(function(n){r.seatOwner.isValid=!1;r.serverError=n===100002?"SEATOWNER_MANDATORY_FIELDS_MISSING":"SEATOWNER_UNKNOWN_ERROR"}).finally(function(){r.isProcessingRequest=!1;r.updateUI()})};r.loadOwnerFromModel();r.ownerDetailsAvailable&&(r.editMode=!1)}angular.module("elbphilharmonie").component("seatOwner",{bindings:{saveSeatOwner:"<",seatOwner:"<",readOnly:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("seatOwner/seatOwner.html")});n.$inject=["$timeout","$scope","uniqueIdService"]}(),function(){function n(n,t,i,r,u){var f=this,e;f.customer=null;f.initialized=!1;f.processingCounter=0;f.partnerAccounts=null;e=null;f.isLoading=function(){return!f.initialized||f.processingCounter>0||f.partnerAccounts==null};u.all([n.getCustomer(!0),n.getPlazaPartnerAccounts()]).then(function(n){f.customer=n[0];f.partnerAccounts=n[1]}).finally(function(){f.initialized=!0});f.getPlazaPartnerAccounts=function(){n.getPlazaPartnerAccounts().then(function(n){f.partnerAccounts=n})};f.onSuccessfulLogin=function(n){typeof f.redirectOnSuccessfulLoginUrl=="string"&&f.redirectOnSuccessfulLoginUrl!=null&&f.redirectOnSuccessfulLoginUrl!==""&&(window.location.href=f.redirectOnSuccessfulLoginUrl);f.customer=n};f.onRegister=function(n){f.onSuccessfulLogin(n)};f.onLogin=function(n){f.onSuccessfulLogin(n);f.getPlazaPartnerAccounts()};f.handleFormProcessing=function(n){f.processingCounter++;n.finally(function(){f.processingCounter--})};f.isOverview=function(){return e==null};f.showOverview=function(){e=null};f.isPage=function(n){return e===n};f.switchToPage=function(n){t.path("/"+n);e=n};f.switchToOverview=function(){t.path("/");e=null};f.logout=function(){window.location.href=f.logoutUrl};i.$watch(function(){return t.path()},function(n){e=n&&n.length>1?n.substr(1):null})}angular.module("elbphilharmonie").component("selfCare",{bindings:{dsgvo:"@",externalGuidedTourHeadline:"@",externalGuidedTourDescription:"@",phoneNumberMandatory:"<",logoutUrl:"@",redirectOnSuccessfulLoginUrl:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCare/selfCare.html")});n.$inject=["customerService","$location","$scope","scrollService","$q"]}(),function(){function n(n){var t=this;t.success=!1;t.submitted=!1;t.serverError=null;t.cancel=function(){t.onCancel()};t.submit=function(){t.submitted=!0;t.form.$valid&&(t.serverError=null,n.changeEmail(t.email).then(function(){t.success=!0}).catch(function(n){t.serverError=n.errorCode===200021?"EMAIL_ALREADY_EXISTS":n.errorCode===200025?"AMBIGUOUS_EMAIL":n.errorCode===200027?"EMAIL_UNCHANGED":"UNKNOWN_ERROR"}))}}angular.module("elbphilharmonie").component("selfCareChangeEmail",{bindings:{pageId:"@",onCancel:"&",onSuccess:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareChangeEmail/selfCareChangeEmail.html")});n.$inject=["customerService"]}(),function(){function n(n){var t=this;t.submitted=!1;t.serverError=null;t.success=!1;t.submit=function(){t.submitted=!0;t.form.$valid&&!t.localError()&&(t.serverError=null,n.changePassword(t.password1).then(function(){t.success=!0}).catch(function(n){t.serverError=n.errorCode===200023?"PASSWORD_TOO_WEAK":"UNKNOWN_ERROR"}))};t.cancel=function(){t.onCancel()};t.localError=function(){return t.password1&&t.password2&&t.password1!==t.password2?"PASSWORDS_DO_NOT_MATCH":null}}angular.module("elbphilharmonie").component("selfCareChangePassword",{bindings:{pageId:"@",onCancel:"&",onSuccess:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareChangePassword/selfCareChangePassword.html")});n.$inject=["customerService"]}(),function(){function n(n){var t=this,i=0,r;t.isDisableAccountHintEnabled=!1;t.isOptInSent=!1;t.isEditing=!1;t.customer=null;t.submitted=!1;t.errorMessage=null;t.isLoading=function(){return i>0||t.customer==null};n.getCustomer().then(function(n){t.customer=n});t.cancel=function(){t.cancelEdit();t.onCancel()};t.handleFormProcessing=function(n){i++;n.finally(function(){i--})};t.edit=function(){t.isEditing=!0};t.cancelEdit=function(){t.isEditing=!1};t.onCustomerDataUpdate=function(n){t.customer=n;t.isEditing=!1};r=null;n.getLanguage().then(function(n){r=n});t.showDisableAccountHint=function(){t.isDisableAccountHintEnabled=!0};t.hideDisableAccountHint=function(){t.isDisableAccountHintEnabled=!1};t.disableAccount=function(){t.submitted=!0;t.form.$valid&&(i++,n.disableAccount(0,"",r).then(function(n){t.isOptInSent=n.result==="Ok";n.result==="Failed"&&(t.errorMessage=n.message)}).finally(function(){i--}))}}angular.module("elbphilharmonie").component("selfCareMyData",{bindings:{pageId:"@",onCancel:"&",phoneNumberMandatory:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyData/selfCareMyData.html")});n.$inject=["customerService"]}(),function(){function n(n){var t=this;t.isLoading=!0;t.serviceUnavailable=!1;t.optInPending=!1;t.optInVerified=!1;t.optInSent=!1;t.distributionLists=undefined;t.getPossibleDistributionLists=function(){return n.getPossibleDistributionLists("LoadDistributionLists").then(function(n){t.optInPending=n.optInPending;t.optInVerified=n.optInVerified;t.distributionLists=n.distributionLists}).catch(function(){t.serviceUnavailable=!0}).finally(function(){t.isLoading=!1})};t.getPossibleDistributionLists();t.saveNewsletterRegistrations=function(){var r,i;for(t.isLoading=!0,r=[],i=0;i<t.distributionLists.length;i++)r.push({identifier:t.distributionLists[i].identifier,selected:t.distributionLists[i].selected});n.saveNewsletterRegistrations(r).then(function(){t.goToOverview()}).catch(function(n){n&&n.errorCode===200029&&(t.optInSent=!0)}).finally(function(){t.isLoading=!1})};t.goToOverview=function(){t.onCancel()};t.resendOptIn=function(){t.isLoading=!0;n.resendOptIn().then(function(){t.optInSent=!0}).catch(function(){}).finally(function(){t.isLoading=!1})}}angular.module("elbphilharmonie").component("selfCareMyNewsletters",{bindings:{pageId:"@",onCancel:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyNewsletters/selfCareMyNewsletters.html")});n.$inject=["newsletterService"]}(),function(){function n(n,t){var i=this;i.orderInfos=null;i.isLoading=!0;n.getCustomerOrderInfos().then(function(n){i.orderInfos=n}).finally(function(){t(function(){i.isLoading=!1},500)});i.cancel=function(){i.onCancel()};i.showTicketDeliveryForm=function(n){var t=new Date;return t<new Date(n)}}angular.module("elbphilharmonie").component("selfCareMyOrders",{bindings:{pageId:"@",onCancel:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrders.html")});n.$inject=["orderService","$timeout"]}(),function(){function n(n){var t=this;t.isLoading=!1;t.collapsed=!0;t.order=null;t.toggleGroup=function(){t.collapsed?(t.order||(t.isLoading=!0,n.getCustomerOrder(t.orderInfo.id).then(function(n){t.order=n}).finally(function(){t.isLoading=!1})),t.collapsed=!1):t.collapsed=!0}}angular.module("elbphilharmonie").component("selfCareMyOrder",{bindings:{orderInfo:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrder.html")});n.$inject=["orderService","dateUtils"]}(),function(){function n(){var n=this;n.showTicketDeliveryForm=function(n){var t=new Date;return t<new Date(n)};n.sellingCompany=function(){var t,i,r;if(n.group.items.length===0||(t=n.group.items[0].sellingCompany,typeof t!="object"||t==null||typeof t.name!="string"||t.name===""))return null;for(i=1;i<n.group.items.length;i++)if(r=n.group.items[i].sellingCompany,typeof r!="object"||r==null||r.name!==t.name)return null;return t}}angular.module("elbphilharmonie").component("selfCareMyOrderGroup",{bindings:{group:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/selfCareMyOrderGroup.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupArticleItem",{bindings:{orderItem:"<",sellingCompany:"<",firstInGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupArticleItem/orderGroupArticleItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupExternalGuidedTourItem",{bindings:{orderItem:"<",firstInGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupExternalGuidedTourItem/orderGroupExternalGuidedTourItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupGuidedGroupTourItem",{bindings:{orderItem:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupGuidedGroupTourItem/orderGroupGuidedGroupTourItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupGuidedTourItem",{bindings:{orderItem:"<",firstInGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupGuidedTourItem/orderGroupGuidedTourItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupPlazaGroupTicketItem",{bindings:{orderItem:"<",firstInGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupPlazaGroupTicketItem/orderGroupPlazaGroupTicketItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupPlazaTicketItem",{bindings:{orderItem:"<",firstInGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupPlazaTicketItem/orderGroupPlazaTicketItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupSubscriptionItem",{bindings:{orderItem:"<",firstInGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupSubscriptionItem/orderGroupSubscriptionItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupTicketItem",{bindings:{orderItem:"<",firstInGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupTicketItem/orderGroupTicketItem.html")});n.$inject=[]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("orderGroupVoucherItem",{bindings:{orderItem:"<",firstInGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyOrders/selfCareMyOrder/selfCareMyOrderGroup/orderGroupVoucherItem/orderGroupVoucherItem.html")});n.$inject=[]}(),function(){function n(n){var t=this;t.raffles=null;n.getCustomerRaffleRegistrations().then(function(n){t.raffles=n});t.cancel=function(){t.onCancel()}}angular.module("elbphilharmonie").component("selfCareMyRaffles",{bindings:{onCancel:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyRaffles/selfCareMyRaffles.html")});n.$inject=["raffleRegistrationService"]}(),function(){function n(n){var t=this,i=0;t.seasons=null;t.isLoading=function(){return i>0};t.loadSubscriptions=function(){i++;n.getCustomerSubscriptions().then(function(n){t.seasons=n;i--}).catch(function(){i--})};t.loadSubscriptions();t.getSeasonHeadline=function(n){var i=n.name;return n.from!=null&&n.to!=null&&(i+=" ("+t.getDateFromString(n.from)+" - "+t.getDateFromString(n.to)+")"),i};t.cancel=function(){t.onCancel()}}angular.module("elbphilharmonie").component("selfCareMySubscriptions",{bindings:{onCancel:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMySubscriptions/selfCareMySubscriptions.html")});n.$inject=["orderService","customerService"]}(),function(){function n(n){var t=this;t.saveSeatOwner=function(i){return new Promise(function(r,u){n.saveOrderItemSeatOwner(t.seat.orderItemId,i).then(function(n){n.success?r():u(n.errorCode)}).catch(function(){u()})})}}angular.module("elbphilharmonie").component("selfCareMySubscriptionsItem",{bindings:{seat:"<",index:"<",isEditable:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMySubscriptionsItem/selfCareMySubscriptionsItem.html")});n.$inject=["orderService"]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("selfCareMyExternalGuidedTour",{bindings:{headline:"@",description:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyExternalGuidedTour/selfCareMyExternalGuidedTour.html")});n.$inject=[]}(),function(){function n(n){var t=this;t.open=!1;t.setDefaultTarget?(t.targetDevice=t.ticket.defaultDeliveryTargetDevice,t.ticketOwner=t.ticket.defaultTicketOwner):(t.targetDevice=null,t.ticketOwner=null);t.submitted=!1;t.isTicketOwnerChange=!1;t.confirmationMessage=null;t.errorMessage=null;t.ticketSent=null;t.onlineTicketDeliveryDataTargetDevice=null;t.onlineTicketDeliveryDataTicketOwner=null;t.isTargetDeviceValid=!0;t.isTicketOwnerFormValid=!0;t.isFormValid=function(n,i,r){return(t.isTicketOwnerFormValid=typeof i=="string"&&i.trim().length>1,n==="download")?(t.isTargetDeviceValid=!0,t.isTicketOwnerFormValid):(t.isTargetDeviceValid=typeof r=="string"&&r.trim().length>3,t.isTicketOwnerFormValid&&t.isTargetDeviceValid)};t.checkAndCorrectTicketTargetDevice=function(){(t.submitted=!0,t.isFormValid("send",t.ticketOwner,t.targetDevice))&&n.checkAndCorrectTicketTargetDevice(t.ticket.ticketNumber,t.ticket.ticketToken,t.targetDevice,t.ticketOwner).then(function(n){n.ResultCode==="Ok"?(t.confirmationMessage=n.Message,t.confirmationEnabled=n.confirmationEnabled,t.targetDevice=n.CorrectedTargetDevice,t.showConfirmationStep()||t.sendTicket(t.targetDevice,t.ticketOwner)):t.errorMessage=n.Message})};t.sendTicket=function(i,r){(t.submitted=!0,t.isFormValid("send",r,i))&&n.sendOnlineTicket(t.ticket.ticketNumber,t.ticket.ticketToken,i,r).then(function(n){n.ResultCode==="Ok"?(t.confirmationMessage=n.Message,t.ticketSent=!0,t.onlineTicketDeliveryDataTargetDevice=n.onlineTicketDeliveryDataTargetDevice,t.onlineTicketDeliveryDataTicketOwner=n.onlineTicketDeliveryDataTicketOwner,t.ticket.onlineTicketDeliveryDataTargetDevice=n.onlineTicketDeliveryDataTargetDevice,t.ticket.onlineTicketDeliveryDataTicketOwner=n.onlineTicketDeliveryDataTicketOwner):t.errorMessage=n.Message;t.confirmationEnabled=!0})};t.getTicket=function(i){(t.submitted=!0,t.isFormValid("download",i))&&n.getOnlineTicket(t.ticket.ticketNumber,t.ticket.ticketToken,i).then(function(n){if(n.ResultCode==="Ok"){var i=document.createElement("a");i.target="_blank";i.href=n.Url;i.click()}else t.errorMessage=n.Message})};t.changeTicketOwner=function(){t.targetDevice=t.target;t.ticketOwner=t.owner;t.isTicketOwnerChange=!0};t.abort=function(){t.confirmationMessage=null};t.emailKeypress=function(n){n.which===13&&t.checkAndCorrectTicketTargetDevice()};t.showSendStep=function(){return(t.target==null||typeof t.target!="string"||t.owner==null||typeof t.owner!="string"||t.isTicketOwnerChange)&&t.confirmationMessage==null};t.showConfirmationStep=function(){return t.confirmationMessage!=null&&t.confirmationEnabled};t.showResendStep=function(){return(t.target!=null&&typeof t.target=="string"||t.owner!=null&&typeof t.owner=="string")&&!t.isTicketOwnerChange&&t.ticketSent==null};t.show=function(){t.open=!0;t.ticketSent=null;t.confirmationMessage=null;t.isTicketOwnerChange=!1;t.target=t.ticket.onlineTicketDeliveryDataTargetDevice!=null&&typeof t.ticket.onlineTicketDeliveryDataTargetDevice=="string"?t.ticket.onlineTicketDeliveryDataTargetDevice:t.onlineTicketDeliveryDataTargetDevice;t.owner=t.ticket.onlineTicketDeliveryDataTicketOwner!=null&&typeof t.ticket.onlineTicketDeliveryDataTicketOwner=="string"?t.ticket.onlineTicketDeliveryDataTicketOwner:t.onlineTicketDeliveryDataTicketOwner;var n=angular.element(document.querySelector("body"));n.addClass("body--preventscrollingforfullsize")};t.hide=function(){t.open=!1;var n=angular.element(document.querySelector("body"));n.removeClass("body--preventscrollingforfullsize")}}angular.module("elbphilharmonie").component("onlineTicketDeliveryForm",{bindings:{setDefaultTarget:"<",ticket:"<",tosDetailedInformation:"@",onProcessing:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("onlineTicketDeliveryForm/onlineTicketDeliveryForm.html")});n.$inject=["webshopApi"]}(),function(){function n(){var n=this,t={id:n.pageId};n.cancel=function(){n.onCancel()}}angular.module("elbphilharmonie").component("selfCareMyShipping",{bindings:{pageId:"@",onCancel:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("selfCareMyShipping/selfCareMyShipping.html")});n.$inject=[]}(),function(){function n(n,t){function r(){i.numberOfSeats=null;i.priceCategory=null;i.seatSelectionCriteria="";i.contactInfo="";i.firstSeatOwnerIsCustomer=!0;i.seatOwners=[];for(var n=0;n<i.subscription.maxSeats;n++)i.seatOwners.push({gender:null,firstName:"",lastName:"",birthday:""})}var i=this;i.mobile=t.isMobile();i.subscription=t.getSubscription();i.customer=null;r();i.reset=function(){r()};i.saveOrder=function(t){var r=i.seatOwners.slice(0,i.numberOfSeats);return i.firstSeatOwnerIsCustomer&&(r[0]={gender:i.customer.gender,firstName:i.customer.firstName,lastName:i.customer.lastName,birthday:i.customer.birthday}),n.saveSubscriptionOrder(i.customer,i.subscription,{seatOwners:r,priceCategory:i.priceCategory,contactInfo:i.contactInfo,seatSelectionCriteria:i.seatSelectionCriteria,subscribeToNewsletter:t})};i.updateCustomer=function(n){i.customer=n}}angular.module("elbphilharmonie").component("subscriptionOrder",{bindings:{dsgvo:"@",privacyPolicyHint:"@",phoneNumberMandatory:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrder/subscriptionOrder.html")});n.$inject=["subscriptionOrderService","appParameters"]}(),function(){function n(n){var t=this;t.customer=null;t.initialized=!1;t.processingCounter=0;t.isLoading=function(){return!t.initialized||t.processingCounter>0};n.getCustomer(!0).then(function(n){t.customer=n}).finally(function(){t.initialized=!0});t.onRegister=function(n){t.customer=n;t.updateCustomer({$customer:n});t.onSubmit()};t.onCustomerDataUpdate=function(n){t.customer=n;t.updateCustomer({$customer:n});t.onSubmit()};t.onLogin=function(n){t.customer=n};t.handleFormProcessing=function(n){t.processingCounter++;n.finally(function(){t.processingCounter--})}}angular.module("elbphilharmonie").component("subscriptionOrderAuthentication",{bindings:{onSubmit:"&",updateCustomer:"&",dsgvo:"@",phoneNumberMandatory:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrderAuthentication/subscriptionOrderAuthentication.html")});n.$inject=["customerService"]}(),function(){function n(n,i){var r=this;r.returnPath=t(i.getReturnPath(),n.get());r.returnPathLabel=i.getReturnPathLabel();r.hasReturnButton=r.returnPath&&r.returnPathLabel;r.submit=function(){r.onSubmit()}}function t(n,t){if(typeof n!="string")return n;n=i(n);var r="ActivityId="+t,u=n.indexOf("?")>=0?"&":"?";return n+u+r}function i(n){var t,i;return typeof n!="string"?n:(t=-1,n.indexOf("?ActivityId=")>=0?t=n.indexOf("?ActivityId=")+1:n.indexOf("&ActivityId=")>=0&&(t=n.indexOf("&ActivityId=")+1),t===-1)?n:(n.indexOf("&",t)>=0?i=n.indexOf("&",t)+1:(t=t-1,i=n.length),r(n,t,i))}function r(n,t,i){return n.slice(0,t)+n.slice(i)}angular.module("elbphilharmonie").component("subscriptionOrderConfirmation",{bindings:{subscription:"<",onSubmit:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrderConfirmation/subscriptionOrderConfirmation.html")});n.$inject=["activityId","appParameters"]}(),function(){function n(n,t,i){function o(n,t){return n==null||t==null||n<=t}function f(n){r.numberOfSeatsOptions=[u];for(var t=1;t<=n;t++)r.numberOfSeatsOptions.push({value:t,label:t})}function e(){r.priceCategoryOptions=[u];r.subscription.priceCategories.forEach(function(n){var t=n.soldOut||!o(r.numberOfSeats,n.contingent);r.priceCategoryOptions.push({value:n,label:t?n.soldOutString:n.label,soldOut:t,contingent:n.contingent})})}var r=this,u;r.submitted=!1;r.contingentError=!1;u={value:null,label:"..."};n("GENERAL_FORMS_PLEASESELECT").then(function(n){u.label=n});f(r.subscription.maxSeats);e();r.numberOfSeatsChanged=function(){e()};r.priceCategoryChanged=function(){var n=r.priceCategory.contingent!=null?r.priceCategory.contingent:r.subscription.maxSeats;f(n)};r.submit=function(){r.submitted=!0;r.form.$valid&&i.ensureSubscriptionOrderHold(r.subscription.id,r.priceCategory.id,r.numberOfSeats).then(function(){t.logInfo(1,"Statuscode: 0 - Info\r\nDer Benutzer hat ein Abo gewählt.\r\nAbo: "+r.subscription.name+"\r\nPlätze: "+r.numberOfSeats+"\r\nPreiskategorie: "+r.priceCategory.name+"\r\nKriterien Platzauswahl: "+r.seatSelectionCriteria+"\r\nKontakt: "+r.contactInfo);r.onSubmit()}).catch(function(){r.contingentError=!0})}}angular.module("elbphilharmonie").component("subscriptionOrderDetails",{bindings:{subscription:"<",numberOfSeats:"=",priceCategory:"=",seatSelectionCriteria:"=",contactInfo:"=",onSubmit:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrderDetails/subscriptionOrderDetails.html")});n.$inject=["$translate","loggingService","subscriptionOrderService"]}(),function(){function n(n){function r(){var t=n.isMobile()?50:100;$("html, body").animate({scrollTop:$(".subscription-order-steps").offset().top-t+"px"},"slow")}var u=this,t,i;n.isMobile()||(t=$(".progress-wrapper .progress").offset().top+$(".progress-wrapper .progress").height(),i=$(window).scrollTop()+$(window).height(),t>i&&window.setTimeout(r,250))}angular.module("elbphilharmonie").component("subscriptionOrderIntro",{bindings:{subscription:"<",onSubmit:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrderIntro/subscriptionOrderIntro.html")});n.$inject=["appParameters"]}(),function(){function n(n){function r(){var r=0,u="";for(t.firstSeatOwnerIsCustomer&&(r=1,u=r+". Platz\r\n"+i(t.customer));t.numberOfSeats<=t.seatOwners.length&&r<t.numberOfSeats;)u+=" "+(r+1)+". Platz:\r\n"+i(t.seatOwners[r]),r++;n.logInfo(1,"Statuscode: 0 - Info\r\nDer Benutzer hat die Abo Platzinhaber festgelegt.\r\n"+u)}function i(n){var t="";return n.gender==="male"?t="Herr":n.gender==="female"&&(t="Frau"),t+" "+n.firstName+" "+n.lastName+"\r\ngeb. "+n.birthday+"\r\n"}var t=this;t.isAdditionalSeatOwnerVisible=function(n,i){return i>0&&i<t.numberOfSeats};t.submit=function(){t.submitted=!0;t.form.$valid&&(r(),t.onSubmit())}}angular.module("elbphilharmonie").component("subscriptionOrderSeatOwners",{bindings:{numberOfSeats:"<",firstSeatOwnerIsCustomer:"=",hideGender:"<",customer:"<",seatOwners:"<",onSubmit:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrderSeatOwners/subscriptionOrderSeatOwners.html")});n.$inject=["loggingService"]}(),function(){function n(){var n=this,t={id:n.stepId,index:parseInt(n.stepIndex),name:n.name,inProgressIndicator:n.inProgressIndicator!==!1};n.hasOwnProperty("heading")&&(t.heading=n.heading);n.isVisible=function(){return n.stepsController.currentStep===t};this.$onInit=function(){n.stepsController.registerStep(t)}}angular.module("elbphilharmonie").component("subscriptionOrderStep",{bindings:{name:"@",stepId:"@",stepIndex:"@",heading:"@",inProgressIndicator:"<"},transclude:!0,controller:n,require:{stepsController:"^^subscriptionOrderSteps"},templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrderSteps/subscriptionOrderStep.html")})}(),function(){function n(n,t,i){function f(n,t){for(var i=0;t.length>i&&t[i].index<n.index;)i++;t.splice(i,0,n)}function e(n){return r.steps.length===0?!1:!r.currentStep&&n!==r.steps[0]?!1:r.currentStep===u()?!1:r.steps.indexOf(n)<=r.steps.indexOf(r.currentStep)+1}function u(){return r.steps[r.steps.length-1]}function o(){var n=i.isMobile()?50:100;$("html, body").animate({scrollTop:$(".subscription-order-steps").offset().top-n+"px"},"fast")}var r=this;r.steps=[];r.currentStep=null;r.registerStep=function(n){f(n,r.steps);r.currentStep=r.steps[0]};r.setInProgressIndicator=function(){};r.proceed=function(){var n=r.steps.indexOf(r.currentStep)+1;n<r.steps.length&&(r.jumpTo(r.steps[n]),o())};n.$on("subscription-order-step-completed",function(){r.proceed()});r.jumpTo=function(n){t.path("/"+n.id)};r.isVisited=function(n){return r.steps.indexOf(n)<r.steps.indexOf(r.currentStep)};r.isCurrent=function(n){return r.steps.indexOf(n)===r.steps.indexOf(r.currentStep)};r.isDisabled=function(n){return r.currentStep===u()&&n!==u()};n.$watch(function(){return t.path()},function(n){if(r.steps.length>0){var f=r.steps.filter(function(t){return n==="/"+t.id}),i=f.shift();i=i||r.steps[0];e(i)?r.currentStep=i:(t.path(""),r.reset&&r.currentStep===u()&&r.reset(),r.currentStep=r.steps[0])}else t.path("")})}angular.module("elbphilharmonie").component("subscriptionOrderSteps",{bindings:{defaultHeading:"@",reset:"&"},transclude:!0,controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrderSteps/subscriptionOrderSteps.html")});n.$inject=["$scope","$location","appParameters","subscriptionOrderService"]}(),function(){function n(n,t,i,r,u){var f=this,e=!1;f.newsletterInitialized=!1;f.gtcInitialized=!1;f.subscribeToNewsletter=!1;f.canSubscribeToNewsletter=!1;f.fileBaseUrl=r.getFileBaseUrl();f.serverError=null;f.gtcConfirmation="";t.canSubscribeToNewsletter("SubscriptionOrder").then(function(n){f.canSubscribeToNewsletter=n}).finally(function(){f.newsletterInitialized=!0;u.$apply()});i.getSubscriptionGtcInfos(f.subscription).then(function(n){f.gtcConfirmation=n.resources.tosConfirmation}).finally(function(){f.gtcInitialized=!0});f.isAdditionalSeatOwnerVisible=function(n,t){return t>0&&t<f.numberOfSeats};f.isLoading=function(){return!f.isInitialized()||e};f.isInitialized=function(){return f.newsletterInitialized&&f.gtcInitialized};f.tosAccepted=!1;f.submit=function(){f.submitted=!0;f.serverError=null;f.form.$valid&&(e=!0,f.save({$subscribeToNewsletter:f.subscribeToNewsletter}).then(function(){f.onSubmit()}).catch(function(n){f.serverError=n.httpStatus===503?"SUBSCRIPTION_ORDER_DISABLED":"UNKNOWN_ERROR"}).finally(function(){e=!1}))}}angular.module("elbphilharmonie").component("subscriptionOrderSummary",{bindings:{subscription:"<",numberOfSeats:"=",priceCategory:"=",firstSeatOwnerIsCustomer:"=",customer:"<",seatOwners:"<",save:"&",onSubmit:"&",privacyPolicyHint:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionOrderSummary/subscriptionOrderSummary.html")});n.$inject=["customerService","newsletterService","subscriptionOrderService","appParameters","$scope"]}(),function(){angular.module("elbphilharmonie").component("subscriptionSeatOwnerInfo",{bindings:{owner:"<",hideGender:"<",largeOffset:"<",large:"<"},templateUrl:$.spiritec.componentTemplateUrl("subscriptionSeatOwnerInfo/subscriptionSeatOwnerInfo.html")})}(),function(){function n(){var n=this;n.prefixWithIndex="seat-owner-"+n.index+"-"}angular.module("elbphilharmonie").component("subscriptionSeatOwnerInputs",{bindings:{seatOwner:"<",form:"<",index:"<",validate:"<",hideGender:"<",largeOffset:"<",large:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("subscriptionSeatOwnerInputs/subscriptionSeatOwnerInputs.html")})}(),function(){function n(){var n=this,t={id:n.tabId,title:n.title};n.isVisible=function(){return n.tabsController.currentTab===t};n.$onInit=function(){n.tabsController.registerTab(t)}}angular.module("elbphilharmonie").component("tab",{bindings:{tabId:"@",title:"@"},transclude:!0,require:{tabsController:"^^tabs"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("tabs/tab.html")});n.$inject=[]}(),function(){function n(n,t){var i=this;i.tabs=[];i.currentTab=null;i.registerTab=function(n){i.tabs.push(n);i.currentTab=i.tabs[0]};i.switchTo=function(t){n.path("/"+t.id)};i.isCurrent=function(n){return i.currentTab===n};t.$watch(function(){return n.path()},function(t){if(i.tabs.length>0){var r=i.tabs.filter(function(n){return t==="/"+n.id});i.currentTab=r.shift()||i.tabs[0]}else n.path("")})}angular.module("elbphilharmonie").component("tabs",{bindings:{},transclude:!0,controller:n,templateUrl:$.spiritec.componentTemplateUrl("tabs/tabs.html")});n.$inject=["$location","$scope"]}(),function(){function n(n,t,i,r,u,f,e){function s(){t.waitingArea(o.productId).then(function(n){n.status==="in-waiting-area"?(o.setWaitingListPosition(n.waitingListPosition),r(function(){s()},15e3)):n.status==="soldout"?o.soldOut=!0:n.status==="sale"||n.status==="few"?(o.mayProceed=!0,c(n.slotValidUntil)):o.notBookable=!0;o.counter++%4==0&&elbphilharmonie.WebshopApi.TriggerCartUpdate()}).catch(function(){r(function(){s()},5e3)})}function h(n){var t=new Date,i=Math.abs(n.getTime()-t.getTime());return Math.round(parseInt(i)/1e3)}function c(t){var i,r=n.parseUtcISODate(t),f=function(){var n=h(r);n<=0&&u.cancel(i);o.countdown=n};i=u(f,500,0)}var o=this;o.mayProceed=!1;o.soldOut=!1;o.notBookable=!1;o.positionIsBelowThreshold=!1;o.counter=0;o.countdown=0;o.proceedToSeatSelection=!1;o.seatSelectionValidUntil=null;o.processingCounter=0;o.isLoading=function(){return o.processingCounter>0};o.proceed=function(){window.location.reload()};o.resetWaitingArea=function(){window.location.reload()};o.showLoading=function(){return!o.mayProceed&&!o.soldOut&&!o.notBookable};s();o.setWaitingListPosition=function(n){(!o.currentWaitingListPosition||n<o.currentWaitingListPosition)&&(o.currentWaitingListPosition=n);o.positionIsBelowThreshold=o.currentWaitingListPosition<o.positionThreshold;e.$apply()};o.registerWaitingAreaAccess=function(){o.processingCounter++;t.waitingAreaAccessRegistration(o.productId).then(function(t){t.status==="soldout"?o.soldOut=!0:t.status==="sale"||t.status==="few"?(o.proceedToSeatSelection=!0,o.seatSelectionValidUntil=n.parseUtcISODate(t.slotTimeout)):o.notBookable=!0}).catch(function(){}).finally(o.processingCounter--)};o.cancelWaitingArea=function(){f.location.href=o.eventCalendar}}angular.module("elbphilharmonie").component("waitingArea",{bindings:{productId:"<",eventCalendar:"@",positionThreshold:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("waitingArea/waitingArea.html")});n.$inject=["dateUtils","waitingAreaService","webshopApi","$timeout","$interval","$window","$scope"]}(),function(){function n(n,t){var i=this;i.done=0;i.refreshAllComponents=function(){t.$broadcast("update-plaza-partner");i.done++};i.getCurrentAccountInfo=function(){return n.getPlazaPartnerAccounts(i.accountId).then(function(n){i.accountInfo=n}).catch(function(){})};i.getCurrentAccountInfo()}angular.module("elbphilharmonie").component("plazaPartner",{bindings:{accountId:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaPartner/plazaPartner.html")});n.$inject=["webshopApi","$scope"]}(),function(){function n(n,t,i){function f(){return t.getPlazaPartnerBookingConfirmation(r.bookingInformation.accountId,n.get(),r.bookingInformation.orderId).then(function(n){n.status==="pending"?i(function(){f()},2e3):t.getPlazaPartnerMyBookings(r.accountId,u,null,r.bookingInformation.orderId,null,null,"").then(function(n){r.booking=n[0];r.processingCounter--;r.onSuccess();r.selectedDay=new Date;r.amount="";r.customer="";r.event="";r.note="";r.preSubmitted=!1;r.showTicketDownloadPopup=!0}).finally(function(){})}).catch(function(n){return r.serverError=n.errorCode===200153?"PLAZAPARTNER_ORDER_NOT_FOUND":"UNKNOWN_ERROR",!1})}var r=this,u;r.showModal=0;r.isDatepickerActive=!1;r.bookingInformation=null;r.processingCounter=0;r.showTicketDownloadPopup=!1;r.bookings=null;r.preSubmitted=!1;r.submitted=!1;r.serverError="";r.selectedDay=new Date;u=new Date;u.setDate(u.getDate()-10);r.showDatePicker=function(){r.isDatepickerActive=!0};r.hideDatePicker=function(){r.isDatepickerActive=!1};r.submitBookingRequest=function(){r.preSubmitted=!0;r.bookingDataPreForm.$valid&&r.showModal++};r.abortBookingRequest=function(){r.showModal--;r.submitted=!1};r.bookTickets=function(){r.submitted=!0;r.bookingDataForm.$valid&&(r.processingCounter++,t.bookPlazaPartnerContingent(n.get(),r.accountId,r.selectedDay,parseInt(r.amount),r.customer,r.event,r.note).then(function(n){r.bookingInformation=n;f()}).catch(function(n){r.serverError=n.errorCode===200150?"PLAZAPARTNER_DATE_MISSING":n.errorCode===200151?"PLAZAPARTNER_AMOUNT_MISSING":n.errorCode===200152?"PLAZAPARTNER_CUSTOMER_MISSING":n.errorCode===200154?"PLAZAPARTNER_CONTINGENT_DEPLETED":"UNKNOWN_ERROR";r.processingCounter--}).finally(function(){}))};r.getBookedTicketsInformation=function(){return t.getPlazaPartnerMyBookings(r.accountId,u,null,r.bookingInformation.orderId,null,null,"")};r.onDateSelected=function(n){r.selectedDay=new Date(n);r.hideDatePicker()};r.hideTicketDownload=function(){r.showModal--;r.showTicketDownloadPopup=!1}}angular.module("elbphilharmonie").component("plazaPartnerBookingForm",{bindings:{accountId:"@",onSuccess:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaPartnerBookingForm/plazaPartnerBookingForm.html")});n.$inject=["activityId","webshopApi","$timeout","$filter"]}(),function(){function n(n,t){function r(){return n.getPlazaPartnerBookingOverview(i.accountId).then(function(n){i.bookingOverview=n})}function u(){return n.getPlazaPartnerBookingOverviewExport(i.accountId,null).then(function(n){console.dir(n);i.bookingsOverviewExportData=n[0];i.exportSelectedYear=i.bookingsOverviewExportData.year})}var i=this;i.bookingOverview=null;i.bookingsOverviewExportData=null;t.$on("update-plaza-partner",function(){r()});r();u()}angular.module("elbphilharmonie").component("plazaPartnerBookingOverview",{bindings:{accountId:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaPartnerBookingOverview/plazaPartnerBookingOverview.html")});n.$inject=["webshopApi","$scope"]}(),function(){function n(n,t,i){function f(t,i,f){return n.getPlazaPartnerMyBookings(r.accountId,u,null,null,t,i,f).then(function(n){r.bookings=n})}var r=this,u,e,o,s;r.bookings=null;r.queryFromDate="";r.queryUntilDate="";r.queryInfo="";u=new Date;u.setDate(u.getDate()-10);r.refreshListUsingSearchFields=function(){f(r.queryFromDate,r.queryUntilDate,r.queryInfo)};r.setDateSearchFieldsToWeek=function(n){var i=new Date,t=(i.getDay()-1)*-1+n*7,u=t+6;r.setDateSearchFields(t,u)};r.setDateSearchFields=function(n,t){r.queryFromDate=n==null?"":i.formatAsGermanDate(i.getDateFromToday(n));r.queryUntilDate=t==null?"":i.formatAsGermanDate(i.getDateFromToday(t));r.refreshListUsingSearchFields()};r.getFilteredBookings=function(){var t=new Date(r.queryFromDate.split(".")[2],r.queryFromDate.split(".")[1]-1,r.queryFromDate.split(".")[0]),i=new Date(r.queryUntilDate.split(".")[2],r.queryUntilDate.split(".")[1]-1,r.queryUntilDate.split(".")[0]),n;t>i&&(n=r.queryFromDate,r.queryFromDate=r.queryUntilDate,r.queryUntilDate=n);f(r.queryFromDate,r.queryUntilDate,r.queryInfo);e=r.queryFromDate;o=r.queryUntilDate;s=r.queryInfo};t.$on("update-plaza-partner",function(){f(e,o,s)});r.setDateSearchFields(0,0)}angular.module("elbphilharmonie").component("plazaPartnerTicketsList",{bindings:{accountId:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaPartnerTicketsList/plazaPartnerTicketsList.html")});n.$inject=["webshopApi","$scope","dateUtils"]}(),function(){function n(n,t){function r(){return n.getPlazaPartnerBookingConfirmation(i.booking.AccountId,i.booking.ActivityId,i.booking.OrderId).then(function(n){if(n.status==="pending")t(function(){return r()},2e3);else return!0}).catch(function(n){return n.errorCode===200120?i.serverError="PLAZAPARTNER_ORDER_NOT_FOUND":i.error="UNKNOWN_ERROR",!1})}var i=this;i.showTicketDownloadPopup=!1;i.showTicketDownload=function(){i.showTicketDownloadPopup=r()};i.hideTicketDownload=function(){i.showTicketDownloadPopup=!1};i.submitTicketRequest=function(){t(function(){i.hideTicketDownload()},2e3)}}angular.module("elbphilharmonie").component("plazaPartnerTicketsListItem",{bindings:{booking:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaPartnerTicketsListItem/plazaPartnerTicketsListItem.html")});n.$inject=["webshopApi","$timeout"]}(),function(){function n(n){function f(){return n.getPlazaPartnerContingents(t.accountId,null,2).then(function(n){t.calendar=n})}function r(n,i){t.calendar.SelectedMonth=n;t.calendar.SelectedMonthDisplay=t.calendar.MonthNames[n];t.calendar.SelectedYear=i}var t=this,i,u;t.selectedDateContingent=new Date;i=new Date;u=new Date(i.getMonth()+1,0);t.activeDay=null;t.calendar=[];t.calendar.Months=[];f();t.NextMonth=function(n,t){n===12?(n=1,t++):n++;r(n,t)};t.PreviousMonth=function(n,t){n===1?(n=12,t--):n--;r(n,t)};t.IsBookable=function(n){return n.Articles.map(function(n){return n.SoldOut===!1}).indexOf(!0)>-1};t.CanNavigateForwards=function(n,i){return t.calendar.Months.map(function(t){return t.Month>n&&t.Year===i||t.Month<=n&&t.Year>i}).indexOf(!0)>-1};t.CanNavigateBackwards=function(n,i){return t.calendar.Months.map(function(t){return t.Month<n&&t.Year===i||t.Month>=n&&t.Year<i}).indexOf(!0)>-1};t.DayClick=function(n){if(n){t.activeDay=n;console.dir(n);t.onDateSelected({date:n.Day})}};t.isActiveDay=function(n){return t.activeDay==n}}angular.module("elbphilharmonie").component("plazaPartnerCalendar",{bindings:{accountId:"@",onProcessing:"&",onDateSelected:"&",selectedDateContingent:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaPartnerCalendar/plazaPartnerCalendar.html")});n.$inject=["webshopApi"]}(),function(){function n(){var n=this;n.date=new Date(n.booking.Day)}angular.module("elbphilharmonie").component("plazaPartnerTicketDownload",{bindings:{booking:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaPartnerTicketDownload/plazaPartnerTicketDownload.html")});n.$inject=[]}(),function(){function n(n){var t=this;t.getDefaultGroup=function(){if(t.guidedTourGroup>0)return t.guidedTourGroup.toString();if(t.filterTitle!==""&&t.groups.length>0){var n=t.groups.filter(function(n){return n.name===t.filterTitle})[0].id.toString();t.onGroupChanged({groupId:n});return n}return"-1"};t.enableGuidedTourGroups=!1;t.getGuidedTourGroups=function(){return n.getGuidedTourGroups(t.ticketType).then(function(n){t.groupsDefaultText=n.groupsDefaultText;t.groups=n.groups;t.enableGuidedTourGroups=n.groups.length>1;t.group=t.getDefaultGroup()})};(t.ticketType===4||t.ticketType===5)&&t.getGuidedTourGroups()}angular.module("elbphilharmonie").component("plazaTicketHeader",{bindings:{headline:"@",description:"@",filterTitle:"@",ticketType:"<",guidedTourGroup:"<",onGroupChanged:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaTicketHeader/plazaTicketHeader.html")});n.$inject=["webshopApi"]}(),function(){function n(n,t,i,r){function o(){return t.getPlazaData(u.ticketType,u.filterGuidedTourGroup).then(function(n){u.nextAvailableDate=n.nextAvailableDate;u.cartUrl=n.cartUrl;f=e();u.onProcessing({promise:f})})}function e(){var i=n.parseISODate(u.nextAvailableDate),r=new Date(i);return r=new Date(r.setDate(i.getDate()+6)),t.getPlazaTicketContingentsInfo(i,r,u.ticketType,u.filterGuidedTourGroup,u.filterDate,u.filterTime).then(function(n){u.days=n;u.openCalendar=u.filterDate&&!u.days.some(function(n){return n.isActive})})}var u=this,f;u.selectedDay=null;u.openCalendar=!1;f=o();u.onProcessing({promise:f});u.onDateSelected=function(n){n&&(u.selectedDay=null,t.getPlazaTicketContingentsInfo(n,n,u.ticketType,u.filterGuidedTourGroup).then(function(n){u.selectedDay=n[0]}))};u.onGuidedTourGroupChanged=function(n){n<=-1&&(n=null);u.filterGuidedTourGroup=n;r.$broadcast("update-guided-groups",{groupId:n});e()}}angular.module("elbphilharmonie").component("plazaTicket",{bindings:{headline:"@",description:"@",cartUrl:"@",onProcessing:"&",ticketType:"<",useGroupedTimeslots:"<",useDayPeriods:"<",filterTitle:"@",filterDate:"@",filterTime:"@",filterGuidedTourGroup:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaTicket/plazaTicket.html")});n.$inject=["dateUtils","webshopApi","scrollService","$scope"]}(),function(){function n(n,t){var i=this;i.contingents=[];i.getPlazaTicketContingents=function(){return n.getPlazaTicketProducts(i.day.date,i.ticketType,i.filterGuidedTourGroup).then(function(n){i.contingents=n})};i.getPlazaTicketContingents();i.isToday=function(){return t.equalsDateWithOffset(i.getDateFromString(i.day.date),0)&&t.isClientInServerTimeZone()};i.isTomorrow=function(){return t.equalsDateWithOffset(i.getDateFromString(i.day.date),1)&&t.isClientInServerTimeZone()};i.getDateFromString=function(n){return t.transformTimeZone(new Date(n))}}angular.module("elbphilharmonie").component("plazaTicketDay",{bindings:{cartUrl:"<",day:"<",ticketType:"<",filterGuidedTourGroup:"<",filterDate:"@",filterTime:"@",useSmallTimeslotName:"<",useGroupedTimeslots:"<",useDayPeriods:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaTicketDay/plazaTicketDay.html")});n.$inject=["webshopApi","dateUtils","$scope"]}(),function(){function n(n){var t=this,i=n.parseISODate(t.filterDate),r=n.parseISODate(t.filterTime);t.defaultOpen=t.period.articles.some(function(u){var f=n.parseISODate(u.date),e=n.parseISODate(u.timeslotStart);return t.filterDate&&t.filterTime&&n.equalsDate(f,i)&&n.equalsTime(e,r)})}angular.module("elbphilharmonie").component("plazaTicketDayPeriod",{bindings:{cartUrl:"<",useSmallTimeslotName:"<",useGroupedTimeslots:"<",period:"<",filterDate:"@",filterTime:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaTicketDayPeriod/plazaTicketDayPeriod.html")});n.$inject=["dateUtils"]}(),function(){function n(n,t){var i=this;i.showLoading=0;i.showSuccess=0;i.resetDropdown=function(){i.availableTickets.selectedOption="0"};i.initOptions=function(){for(var t=[],n=i.timeslot.startAmount;n<=i.timeslot.amount;n++)t.push({id:n,name:n});i.availableTickets.availableOptions=t};i.availableTickets={};i.initOptions();i.resetDropdown();i.soldOut=function(){return i.timeslot.amount<=0};i.shortenPlazaTicketName=function(n){var t=n.match(/\d\d:\d\d\s?-\s?\d\d:\d\d/gi);return t!==null&&typeof t!="undefined"&&t.length>0?t[0]:n};i.smallTimeslotName=i.timeslot.name?i.shortenPlazaTicketName(i.timeslot.name.toString()):"";i.AddToCart=function(t,r,u,f){i.showLoading++;i.timeslot.ticketType===5&&(u=1);var e=n.addPlazaTicketToCart(t,r,u,f);i.onProcessing({promise:e});e.then(function(n){n.success?(elbphilharmonie.WebshopApi.SetCartProductCount(n.cartItemCount),i.showbanner()):i.showLoading--}).catch(function(){i.showLoading--})};i.showbanner=function(){i.showSuccess++;t(function(){i.showLoading--;i.showSuccess--;i.resetDropdown()},5e3)};i.showQuantity=function(){return!i.soldOut()&&i.timeslot.ticketType!==5}}angular.module("elbphilharmonie").component("plazaTicketTimeslot",{bindings:{onProcessing:"&",timeslot:"<",useSmallTimeslotName:"<",cartUrl:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaTicketTimeslot/plazaTicketTimeslot.html")});n.$inject=["webshopApi","$timeout"]}(),function(){function n(n,t,i,r){var u=this;u.showLoading=0;u.showSuccess=0;u.defaultOption=function(){var n=r.parseISODate(u.filterDate),t=r.parseISODate(u.filterTime);return u.timeslots.find(function(i){var f=r.parseISODate(i.date),e=r.parseISODate(i.timeslotStart);return u.filterDate&&u.filterTime&&r.equalsDate(f,n)&&r.equalsTime(e,t)})};u.selectedTimeslot=u.defaultOption();u.shortenPlazaTicketName=function(n){var t=n.match(/\d\d:\d\d\s?-\s?\d\d:\d\d/gi);return t!==null&&typeof t!="undefined"&&t.length>0?t[0]:n};u.AddToCart=function(t,r,f,e){u.showLoading++;var o=n.addPlazaTicketToCart(t,r,f,e);u.onProcessing({promise:o});o.then(function(n){n.success?(elbphilharmonie.WebshopApi.SetCartProductCount(n.cartItemCount),i.location.href=u.cartUrl):u.showLoading--}).catch(function(){u.showLoading--})};u.soldOut=function(){return!1};u.amountRange=function(){var t,n;if(u.selectedTimeslot!=null){for(t=[],n=1;n<=u.selectedTimeslot.amount;n++)t.push(n);return t}};u.hasContingents=function(){return u.timeslots.some(function(n){return n.amount>0})}}angular.module("elbphilharmonie").component("plazaTicketTimeslotgroup",{bindings:{onProcessing:"&",cartUrl:"<",timeslots:"<",filterDate:"@",filterTime:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaTicketTimeslotgroup/plazaTicketTimeslotgroup.html")});n.$inject=["webshopApi","loggingService","$window","dateUtils"]}(),function(){function n(n,t){function r(){return n.getPlazaTicketContingents(i.ticketType,i.filterGuidedTourGroup,i.filterDate).then(function(n){i.calendar=n;i.filterDate&&f()})}function f(){var n,t,r;for(let u=0;u<i.calendar.Months.length;u++)if(n=i.calendar.Months[u],n.IsActive)for(let u=0;u<n.Weeks.length;u++){t=n.Weeks[u];for(let n=0;n<t.Days.length;n++)if(r=t.Days[n],r.IsActive){i.DayClick(r);return}}return}function u(n,t){i.calendar.SelectedMonth=n;i.calendar.SelectedMonthDisplay=i.calendar.MonthNames[n];i.calendar.SelectedYear=t}var i=this;i.activeDay=null;i.calendar=[];i.calendar.Months=[];r();t.$on("update-guided-groups",function(n,t){i.filterGuidedTourGroup=t.groupId;r();i.DayClick(i.activeDay)});i.NextMonth=function(n,t){n===12?(n=1,t++):n++;u(n,t)};i.PreviousMonth=function(n,t){n===1?(n=12,t--):n--;u(n,t)};i.IsBookable=function(n){return n.Articles.map(function(n){return n.SoldOut===!1}).indexOf(!0)>-1};i.CanNavigateForwards=function(n,t){return i.calendar.Months.map(function(i){return i.Month>n&&i.Year==t||i.Month<=n&&i.Year>t}).indexOf(!0)>-1};i.CanNavigateBackwards=function(n,t){return i.calendar.Months.map(function(i){return i.Month<n&&i.Year===t||i.Month>=n&&i.Year<t}).indexOf(!0)>-1};i.DayClick=function(n){i.activeDay=n;i.onDateSelected({date:n.Day})};i.isActiveDay=function(n){return i.activeDay?i.activeDay===n:n.IsActive}}angular.module("elbphilharmonie").component("plazaTicketCalendar",{bindings:{ticketType:"<",filterGuidedTourGroup:"<",filterDate:"@",filterTime:"@",onProcessing:"&",onDateSelected:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("plazaTicketCalendar/plazaTicketCalendar.html")});n.$inject=["webshopApi","$scope"]}(),function(){function n(n,t){function r(){n.getBookingConfirmation(i.orderId,i.orderToken,i.paymentRequest).then(function(n){n.status==="pending"?t(function(){r()},2e3):(i.onLoaded(),i.confirmation=n,i.loading=!1);elbphilharmonie.WebshopApi.TriggerCartUpdate()}).catch(function(n){i.serverError=n.errorCode===200120?"ORDER_NOT_FOUND":"UNKNOWN_ERROR";i.loading=!1})}var i=this;i.loading=!0;i.serverError=null;i.confirmation=null;i.showTicketDeliveryForm=function(n){var t=new Date;return t<new Date(n)};r()}angular.module("elbphilharmonie").component("ticketOverview",{bindings:{orderId:"<",paymentRequest:"<",enableTracking:"<",orderToken:"@",onLoaded:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("ticketOverview/ticketOverview.html")});n.$inject=["orderService","$timeout"]}(),function(){function n(n,t,i,r){var u=this;u.errorMessage=null;u.cartUrl=null;u.loading=!1;u.resetDropdown=function(){u.availableMemberships.selectedOption="1"};u.initOptions=function(){for(var e=[],f=1;f<=u.maxMemberships;f++)e.push({id:f,name:f});u.AddToCart=function(){u.loading=!0;var f=n.addMembershipToCart(u.membershipId,u.availableMemberships.selectedOption,t.get());u.onProcessing({promise:f});f.then(function(n){n.success?(elbphilharmonie.WebshopApi.SetCartProductCount(n.cartItemCount),i.logInfo(1,"Statuscode: 0 - Info\r\nEin Element wurde dem Warenkorb hinzugefügt.\r\nElement: "+n.description),r.location.href=u.cartUrl):(u.loading=!1,u.errorMessage=n.errorCode)})};u.availableMemberships.availableOptions=e};u.availableMemberships={};u.initOptions();u.resetDropdown()}angular.module("elbphilharmonie").component("memberships",{bindings:{onProcessing:"&",cartUrl:"@",backUrl:"@",loginUrl:"@",maxMemberships:"<",isLoggedIn:"<",allowMultiple:"<",membershipId:"<",membershipName:"@",membershipDescription:"@",membershipPrice:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("memberships/memberships.html")});n.$inject=["webshopApi","activityId","loggingService","$window"]}(),function(){function n(n,t,i){var r=this,u;r.bookingInfo=null;r.submitted=!1;r.returnSuccess=null;u=!1;r.isLoading=function(){return u};r.getBookingInfo=function(){u=!0;var i=n.getRaffleRegistrationBookingInfo(t.get(),r.registrationId);r.onProcessing({promise:i});i.then(function(n){r.bookingInfo=n.data.success?n.data.bookingInfo:null}).finally(function(){u=!1})};r.getBookingInfo();r.returnTickets=function(){if(r.submitted=!0,!r.form.confirmation.$invalid){u=!0;var t=n.raffleRegistrationBookingReturn(r.registrationId);r.onProcessing({promise:t});t.then(function(n){n.success?(u=!1,r.returnSuccess=!0):u=!1}).catch(function(){u=!1;r.returnSuccess=!1})}};r.cancelReturnTickets=function(){i.location.href=r.cancelUrl}}angular.module("elbphilharmonie").component("raffleBookingReturn",{bindings:{onProcessing:"&",alreadyPayed:"<",alreadyReturned:"<",bookingPeriodExpired:"<",registrationId:"<",isLoggedIn:"<",loginUrl:"@",cancelUrl:"@",itemName:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleBookingReturn/raffleBookingReturn.html")});n.$inject=["raffleRegistrationService","activityId","$window"]}(),function(){function n(n){var t=this;t.showLoading=0;t.cancelRaffleRegistrationFormVisible=0;t.cancelSuccess=!1;t.showAction=!1;t.showResendCancelMail=t.registration.IsRejectOrderAllowed&&t.registration.Status==="CancelRequested";t.showResendActivationMail=!t.registration.UserIsActive&&t.registration.IsResendActivationMailAllowed;t.cancelRaffleRegistration=function(){t.showLoading++;var i=n.cancelRaffleRegistration(t.registration.Id);t.onProcessing({promise:i});i.then(function(n){n.success?(t.showLoading--,t.cancelSuccess=!0):t.showLoading--}).catch(function(){t.showLoading--})};t.getNumberOfSeats=function(){return t.registration.Reduction!=null&&t.registration.Reduction.Quantity!=null&&t.registration.Reduction.Quantity<=t.registration.Quantity?t.registration.Quantity-t.registration.Reduction.Quantity:t.registration.Quantity};t.showInfoText=function(){return t.registration.InfoText!=null&&(t.registration.Status==null||t.registration.Status==="")};t.showDisplayStatus=function(){return t.registration.DisplayStatus!=null&&t.registration.DisplayStatus!==""};t.showAction=t.registration.IsRejectOrderAllowed||t.registration.IsBookingAllowed;t.showCancelRaffleRegistrationForm=function(){t.registration.IsRejectOrderAllowed&&t.cancelRaffleRegistrationFormVisible++};t.hideCancelRaffleRegistrationForm=function(){t.cancelRaffleRegistrationFormVisible--};t.resendCancelMail=function(){t.registration.IsRejectOrderAllowed&&(n.sendRaffleRegistrationMail(t.registration.Id,"RaffleRegistrationCancelConfirmation"),t.showResendCancelMail=!1)};t.resendEmailActivationMail=function(){t.registration.IsResendActivationMailAllowed&&(t.registration.Type==="Event"||t.registration.Type==="EventWheelChair"?n.sendRaffleRegistrationMail(t.registration.Id,"RaffleRegistrationEventEMailConfirmation"):n.sendRaffleRegistrationMail(t.registration.Id,"RaffleRegistrationSubscriptionEMailConfirmation"),t.showResendActivationMail=!1)}}angular.module("elbphilharmonie").component("raffleItem",{bindings:{onProcessing:"&",registration:"<",enableStatusDisplay:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleItem/raffleItem.html")});n.$inject=["raffleRegistrationService"]}(),function(){function n(n,t){function r(){i.numberOfSeats=null;i.priceCategory=null;i.item.alternativePriceCategory=null}var i=this;i.mobile=t.isMobile();i.emailVerified=!1;i.alternativePriceCategoriesEnabled=function(){return i.enableAlternativePriceCategories==="True"||i.enableAlternativePriceCategories==="true"};i.item=i.type==="event"?t.getEvent():t.getSubscription();i.customer=null;i.emailVerified=!0;r();i.reset=function(){r()};i.saveRegistration=function(t,r){var f=null,e=null,u;return i.type==="event"?f=i.item.id:e=i.item.id,u={jtPriceCategoryId:i.priceCategory.id,jtEventId:f,jtSubscriptionId:e,quantity:i.numberOfSeats,alternativePriceCategory:i.item.alternativePriceCategory},u.type=i.type==="event"?0:1,i.item.reductionInfo!=null&&i.item.reductionInfo.reduction.value!=null&&i.item.reductionInfo.reduction.value>-1?u.reductions=i.item.reductionInfo.numberOfSeats+"|"+i.item.reductionInfo.reduction.value:i.item.reductionInfo!=null&&i.item.reductionInfo.reduction.value===-1&&i.item.reductionInfo.numberOfSeats>0&&(u.type=i.type==="event"?2:3,u.reductions=i.item.reductionInfo.numberOfSeats+"|-1"),n.saveRaffleRegistration(i.customer,t,r,u).then(function(n){i.emailVerified=n})};i.updateCustomer=function(n){i.customer=n}}angular.module("elbphilharmonie").component("raffleRegistration",{bindings:{type:"@",productInfo:"@",agbText:"@",requirementsText:"@",isEmailActivation:"@",activationResult:"@",activateUntil:"<",bookingPeriod:"<",maxTickets:"<",enableAlternativePriceCategories:"@",enableCaptcha:"@",language:"@",dsgvo:"@",tosDetailedInformation:"@",privacyPolicyHint:"@",phoneNumberMandatory:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleRegistration/raffleRegistration.html")});n.$inject=["raffleRegistrationService","appParameters","scrollService"]}(),function(){function n(n,t,i){function f(n,t){for(var i=0;t.length>i&&t[i].index<n.index;)i++;t.splice(i,0,n)}function e(n){return r.steps.length===0?!1:!r.currentStep&&n!==r.steps[0]?!1:r.currentStep===u()?!1:r.steps.indexOf(n)<=r.steps.indexOf(r.currentStep)+1}function u(){return r.steps[r.steps.length-1]}function o(){var n=i.isMobile()?50:100;$("html, body").animate({scrollTop:$(".subscription-order-steps").offset().top-n+"px"},"fast")}var r=this;r.steps=[];r.currentStep=null;r.registerStep=function(n){f(n,r.steps);r.currentStep=r.isEmailActivation==="True"?n:r.steps[0]};r.setInProgressIndicator=function(){};r.proceed=function(){var n=r.steps.indexOf(r.currentStep)+1;n<r.steps.length&&(r.jumpTo(r.steps[n]),o())};n.$on("raffle-registration-step-completed",function(){r.proceed()});r.jumpTo=function(n){t.path("/"+n.id)};r.isVisited=function(n){return r.steps.indexOf(n)<r.steps.indexOf(r.currentStep)};r.isCurrent=function(n){return r.steps.indexOf(n)===r.steps.indexOf(r.currentStep)};r.isDisabled=function(n){return r.currentStep===u()&&n!==u()};n.$watch(function(){return t.path()},function(n){if(r.steps.length>0){var f=r.steps.filter(function(t){return n==="/"+t.id}),i=f.shift();i=i||r.steps[0];e(i)?r.currentStep=i:(t.path(""),r.reset&&r.currentStep===u()&&r.reset(),r.currentStep=r.steps[0])}else t.path("")})}angular.module("elbphilharmonie").component("raffleRegistrationSteps",{bindings:{defaultHeading:"@",reset:"&",productInfo:"@",isEmailActivation:"@",type:"@"},transclude:!0,controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleRegistrationSteps/raffleRegistrationSteps.html")});n.$inject=["$scope","$location","appParameters"]}(),function(){function n(){var n=this,t={id:n.stepId,index:parseInt(n.stepIndex),name:n.name,inProgressIndicator:n.inProgressIndicator!==!1};n.hasOwnProperty("heading")&&(t.heading=n.heading);n.isVisible=function(){return n.stepsController.currentStep===t};this.$onInit=function(){n.stepsController.registerStep(t)}}angular.module("elbphilharmonie").component("raffleRegistrationStep",{bindings:{name:"@",stepId:"@",stepIndex:"@",heading:"@",inProgressIndicator:"<"},transclude:!0,controller:n,require:{stepsController:"^^raffleRegistrationSteps"},templateUrl:$.spiritec.componentTemplateUrl("raffleRegistrationSteps/raffleRegistrationStep.html")})}(),function(){function n(n){var t=this,i={value:null,label:"..."},r;n("GENERAL_FORMS_PLEASESELECT").then(function(n){i.label=n});r={value:-1,label:"...",price:null};n("RAFFLEREGISTRATION_GENERAL_WHEELCHAIR").then(function(n){r.label=n});t.showPriceCategorySelection=function(){var n=t.priceCategoryOptions.filter(function(n){return n!==i&&!n.soldOut});return n.length>1};t.reductionOptions=[i];t.setValueOrDefaultReduction=function(){(typeof t.item.reductionInfo=="undefined"||t.item.reductionInfo==null)&&(t.item.reductionInfo={},t.item.reductionInfo.numberOfSeats=0)};t.updateNumberOfSeatsReductions=function(){if(t.numberOfSeats!=null&&t.priceCategory!=null){t.numberOfSeatsReducedOptions=[0];for(var n=1;n<=t.numberOfSeats;n++)t.numberOfSeatsReducedOptions.push(n);t.isReductionSelectionEnabled();typeof t.reductionOptions!="undefined"&&t.reductionOptions.length>0&&typeof t.item.reductionInfo.reduction=="undefined"&&(t.item.reductionInfo.reduction=t.reductionOptions[0]);(typeof t.item.reductionInfo.numberOfSeats=="undefined"||t.item.reductionInfo.numberOfSeats==null)&&(t.item.reductionInfo.numberOfSeats=t.numberOfSeatsOptions[0])}};t.setValueOrDefaultPriceCategory=function(){typeof t.priceCategory!="undefined"&&t.priceCategory!=null||t.showPriceCategorySelection()||(t.priceCategory=t.priceCategoryOptions[1].value,t.updateNumberOfSeatsReductions())};t.setValueOrDefaultReduction();t.submitted=!1;t.item.alternativePriceCategory=!1;t.updatePriceCategoryOptions=function(){t.priceCategoryOptions=[i];t.item.priceCategories.forEach(function(n){typeof t.numberOfSeats=="undefined"||t.numberOfSeats==null?t.priceCategoryOptions.push({value:n,label:n.label,soldOut:n.soldOut||typeof n.maxUtilization!="undefined"&&n.maxUtilization!=null&&n.maxUtilization<=0}):(typeof n.maxUtilization=="undefined"||n.maxUtilization===null||n.maxUtilization>0&&t.numberOfSeats<=n.maxUtilization)&&t.priceCategoryOptions.push({value:n,label:n.label,soldOut:n.soldOut})})};t.updatePriceCategoryOptions();t.setValueOrDefaultPriceCategory();t.isReductionSelectionEnabled=function(){return typeof t.numberOfSeatsReducedOptions!="undefined"&&t.numberOfSeatsReducedOptions.length>1};t.showReductionHint=function(){return(typeof t.priceCategory=="undefined"||t.priceCategory==null||t.priceCategory.priceValue>0)&&t.isReductionSelectionEnabled()&&t.type==="event"};t.isWheelchairSelected=function(){var n=t.item.reductionInfo!=null&&t.item.reductionInfo.reduction!=null&&t.item.reductionInfo.numberOfSeats>0&&t.item.reductionInfo.reduction.value===-1;return n||t.item==null||t.item.reductionInfo==null||(t.item.reductionInfo.wheelchairConfirm=null),n};t.updateReductions=function(){t.priceCategory!=null&&(typeof t.priceCategory.reductions!="undefined"&&t.priceCategory.reductions.length>0?(t.reductionOptions=[i],t.reductionOptions.push(r),t.priceCategory.reductions.forEach(function(n){t.reductionOptions.push({value:n.id,label:n.name,price:n.price})})):(t.reductionOptions=[r],t.item.reductionInfo.reduction=r),t.reductionOptions.forEach(function(n){typeof n!="undefined"&&typeof t.item.reductionInfo.reduction!="undefined"&&n.value===t.item.reductionInfo.reduction.value&&(t.item.reductionInfo.reduction=n)}))};t.updateNumberOfSeats=function(){var r,n;for(t.numberOfSeatsOptions=[i],r=t.maxTickets,t.type==="event"&&typeof t.priceCategory!="undefined"&&t.priceCategory!=null&&typeof t.priceCategory.maxUtilization!="undefined"&&t.priceCategory.maxUtilization!=null&&(r=t.priceCategory.maxUtilization),n=1;n<=r;n++)t.numberOfSeatsOptions.push({value:n,label:n})};t.updateReductionSection=function(){t.updateNumberOfSeatsReductions();t.updateReductions();t.updateNumberOfSeats();t.updatePriceCategoryOptions()};t.updateReductionSection();t.submit=function(){t.submitted=!0;t.form.$valid&&t.onSubmit()}}angular.module("elbphilharmonie").component("raffleRegistrationDetails",{bindings:{item:"=",type:"@",numberOfSeats:"=",priceCategory:"=",enableAlternativePriceCategories:"<",alternativePriceCategory:"=",maxTickets:"<",onSubmit:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleRegistrationDetails/raffleRegistrationDetails.html")});n.$inject=["$translate"]}(),function(){function n(n,t,i,r){var u=this,f=!1;u.initialized=!1;u.subscribeToNewsletter=!1;u.canSubscribeToNewsletter=!1;u.fileBaseUrl=i.getFileBaseUrl();u.serverError=null;u.isValidCaptcha=!1;u.updateReductionInfo=function(){u.item!=null&&u.item.reductionInfo!=null&&u.item.reductionInfo.reduction!=null&&u.item.reductionInfo.reduction.value!=null&&u.item.reductionInfo.reduction.value===-1&&(u.item.reductionInfo.wheelchairConfirm==null||u.item.reductionInfo.wheelchairConfirm==="no")&&(u.item.reductionInfo=null)};u.updateReductionInfo();t.canSubscribeToNewsletter("Checkout").then(function(n){u.canSubscribeToNewsletter=n}).finally(function(){u.initialized=!0;r.$apply()});u.isAdditionalSeatOwnerVisible=function(n,t){return t>0&&t<u.numberOfSeats};u.isLoading=function(){return!u.initialized||f};u.tosAccepted=!1;u.requirementsAccepted=!1;u.submit=function(){if(u.submitted=!0,u.serverError=null,u.form.$valid){f=!0;var n=function(){if(u.enableCaptcha==="True")return grecaptcha.getResponse()};u.save({$subscribeToNewsletter:u.subscribeToNewsletter,$captchaResponse:n()}).then(function(){u.onSubmit()}).catch(function(n){u.serverError=n.errorDescription}).finally(function(){f=!1})}};u.getNumberOfSeats=function(){return u.item.reductionInfo!=null&&u.item.reductionInfo.numberOfSeats!=null&&u.item.reductionInfo.numberOfSeats<=u.numberOfSeats?u.numberOfSeats-u.item.reductionInfo.numberOfSeats:u.numberOfSeats};u.showDateAndTime=function(){return u.item.date!=null};u.enableCaptcha==="True"&&(u.loadCaptcha=function(){$("#captchacontainer").length&&grecaptcha.render("captchacontainer",{sitekey:i.getCaptchaSiteKey(),hl:u.language})})}angular.module("elbphilharmonie").component("raffleRegistrationSummary",{bindings:{item:"<",type:"@",numberOfSeats:"=",priceCategory:"=",customer:"<",save:"&",agbText:"@",requirementsText:"@",enableCaptcha:"<",onSubmit:"&",language:"<",tosDetailedInformation:"@",privacyPolicyHint:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleRegistrationSummary/raffleRegistrationSummary.html")});n.$inject=["customerService","newsletterService","appParameters","$scope"]}(),function(){function n(){var n=this;n.submit=function(){n.onSubmit()}}angular.module("elbphilharmonie").component("raffleRegistrationConfirmation",{bindings:{item:"<",type:"@",onSubmit:"&",emailVerified:"<",activateUntil:"<",email:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleRegistrationConfirmation/raffleRegistrationConfirmation.html")});n.$inject=["activityId","appParameters"]}(),function(){function n(n){function u(){var t=n.isMobile()?50:100;$("html, body").animate({scrollTop:$(".subscription-order-steps").offset().top-t+"px"},"slow")}var t=this,i,r;n.isMobile()||(i=$(".progress-wrapper .progress").offset().top+$(".progress-wrapper .progress").height(),r=$(window).scrollTop()+$(window).height(),i>r&&window.setTimeout(u,250));t.submit=function(){t.onSubmit()}}angular.module("elbphilharmonie").component("raffleRegistrationIntro",{bindings:{item:"<",type:"@",activateUntil:"<",bookingPeriod:"<",maxTickets:"<",onSubmit:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleRegistrationIntro/raffleRegistrationIntro.html")});n.$inject=["appParameters"]}(),function(){function n(){var n=this}angular.module("elbphilharmonie").component("raffleRegistrationEmailActivation",{bindings:{activationResult:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleRegistrationEmailActivation/raffleRegistrationEmailActivation.html")});n.$inject=[]}(),function(){function n(n,t,i){var r=this,u;r.bookingInfo=null;u=!1;r.isLoading=function(){return u};r.getBookingInfo=function(){u=!0;var i=n.getRaffleRegistrationBookingInfo(t.get(),r.registrationId);r.onProcessing({promise:i});i.then(function(n){r.bookingInfo=n.data.success?n.data.bookingInfo:null}).finally(function(){u=!1})};r.getBookingInfo();r.addToCart=function(){u=!0;var f=n.convertRaffleRegistration(t.get(),r.registrationId,r.itemType);r.onProcessing({promise:f});f.then(function(n){n.data.success?(elbphilharmonie.WebshopApi.SetCartProductCount(n.cartItemCount),i.location.href=r.cartUrl):(r.errorMessage=n.errorCode,u=!1)}).catch(function(){u=!1})}}angular.module("elbphilharmonie").component("raffleRegistrationOrder",{bindings:{onProcessing:"&",alreadyPayed:"<",canceled:"<",bookingPeriodExpired:"<",registrationId:"<",isLoggedIn:"<",cartUrl:"@",loginUrl:"@",itemName:"@",itemType:"@",isEvent:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("raffleRegistrationOrder/raffleRegistrationOrder.html")});n.$inject=["raffleRegistrationService","activityId","$window"]}(),function(){function n(n,t,i){var r=this,u=!1;r.serverError=null;r.isLoading=function(){return u};r.bookingInfo=null;r.getReservationCheckoutBookingInfo=function(){u=!0;var n=t.getReservationCheckoutBookingInfo(r.checkoutId,r.checkoutToken);r.onProcessing({promise:n});n.then(function(n){n.success?r.bookingInfo=n.bookingInfo:(r.bookingInfo=n.bookingInfo,n.errorCode===100008?r.errorMessage="UNAUTHORIZED":n.errorCode===200002&&(r.errorMessage="DIFFERENT_USER"))}).finally(function(){u=!1})};r.getReservationCheckoutBookingInfo();r.addToCart=function(){u=!0;var n=t.convertReservation(r.checkoutId,r.checkoutToken,r.itemType);r.onProcessing({promise:n});n.then(function(n){n.success?(elbphilharmonie.WebshopApi.SetCartProductCount(n.cartItemCount),i.location.href=r.cartUrl):(n.errorCode===100001&&(r.errorMessage="UNKNOWN_ERROR"),u=!1)}).catch(function(){u=!1})}}angular.module("elbphilharmonie").component("reservationCheckoutOrder",{bindings:{onProcessing:"&",isLoggedIn:"<",cartUrl:"@",checkoutId:"<",checkoutToken:"@",itemType:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("reservationCheckoutOrder/reservationCheckoutOrder.html")});n.$inject=["appParameters","checkoutService","$window"]}(),function(){function n(n,t){function r(){i.nextUrl&&(t.location.href=i.nextUrl)}var i=this;i.isLoading=function(){return!i.isInitialized||i.processingCounter>0};i.showLoginForm=function(){return i.isInitialized&&i.customerExists};i.showRegistrationForm=function(){return i.isInitialized&&!i.customerExists&&i.customer};i.showAbortError=function(){return i.isInitialized&&!i.customerExists&&!i.customer};i.customer=null;i.isInitialized=!1;i.processingCounter=0;i.customerExists?i.isInitialized=!0:n.getCustomerDataByCheckoutToken(i.checkoutId,i.checkoutToken).then(function(n){i.customer=n}).finally(function(){i.isInitialized=!0});i.handleFormProcessing=function(n){i.processingCounter++;n.finally(function(){i.processingCounter--})};i.onRegister=function(t){return new Promise(function(r,u){n.registerAtReservationCheckout(i.checkoutId,i.checkoutToken,t).then(function(n){r(n)}).catch(function(n){u(n)})})};i.onRegistered=function(){r()};i.onLogin=function(){r()}}angular.module("elbphilharmonie").component("reservationCheckoutAuthentication",{bindings:{checkoutId:"<",checkoutToken:"@",customerExists:"<",nextUrl:"@",dsgvo:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("reservationCheckoutAuthentication/reservationCheckoutAuthentication.html")});n.$inject=["customerService","$window"]}(),function(){function n(){var n=this;n.updateValidation=function(){n.enableEmailRepetition&&n.field.$setValidity("email_match",n.model.emailRepetition===n.model.email)};n.isInvalidEmail=function(){return n.field.$error.required||n.field.$invalid&&!n.field.$error.email_match&&!n.field.blacklist.blocked&&!n.field.blacklist.isBlacklisted};n.showCorrectionHint=function(){return n.field.blacklist!=null&&n.field.blacklist.isBlacklisted&&!n.field.blacklist.blocked};n.isDomainBlocked=function(){return n.field.blacklist!=null&&n.field.blacklist.isBlacklisted&&n.field.blacklist.blocked&&n.field.$invalid};n.isConfirmEmailCheckboxInvalid=function(){return(n.field.blacklist==null||!n.field.blacklist.blocked&&n.field.blacklist.isBlacklisted)&&!n.model.emailCheckbox}}angular.module("elbphilharmonie").component("inputEmail",{bindings:{id:"@",model:"<",field:"<",enableEmailRepetition:"<",submitted:"<",readOnly:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("inputEmail/inputEmail.html")});n.$inject=[]}(),function(){function n(n,t,i){var r=this;r.availableVouchers=[2500,5e3,7500,1e4,15e3,2e4];r.generateTicketCount=function(n){var i=[],t;for(n>10&&(n=10),t=1;t<=n;t++)i[t-1]=t;return i};r.addVoucherToCart=function(t,u){var f=n.addVoucherToCart(t,u).then(function(n){n.success===!1?r.serverError="UNKNOWN_ERROR":(r.serverError="",i.location.href=r.cartUrl)});r.onProcessing({promise:f})};r.submit=function(){r.submitted=!0;r.form.$valid&&r.addVoucherToCart(r.voucherValue,r.selectedCount)}}angular.module("elbphilharmonie").component("vouchers",{bindings:{cartUrl:"@",onProcessing:"&"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("vouchers/vouchers.html")});n.$inject=["webshopApi","scrollService","$window"]}(),function(){function n(n,t){function f(){}var i=this,r,u;i.initialized=!1;r=0;i.isLoading=function(){return r>0};i.submitted=!1;n.getCustomer(!0).then(function(n){r++;i.customer=n}).finally(function(){i.initialized=!0;r--;f()});i.onLogin=function(n){i.customer=n;f()};u=null;n.getLanguage().then(function(n){u=n});i.disableAccount=function(){i.submitted=!0;i.form.$valid&&(r++,n.disableAccount(1,i.token,u).then(function(){t.location.href=i.redirectUrl}).finally(function(){r--}))};i.cancelDisableAccount=function(){r++;n.cancelDisableAccount(i.token,u).then(function(){t.location.href=i.selfCareUrl}).finally(function(){r--})}}angular.module("elbphilharmonie").component("disableAccount",{bindings:{token:"@",redirectUrl:"@",forbiddenUrl:"@",selfCareUrl:"@"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("disableAccount/disableAccount.html")});n.$inject=["customerService","$window"]}(),function(){function n(n,t){var i=this;i.setCheatLinkAccess=function(){n.setCheatLinkAccess(i.eventId,i.token).then(function(n){t.location.href=n.redirectUrl}).catch(function(){alert("error")})}}angular.module("elbphilharmonie").component("limitedCheatLinkBookingInfo",{bindings:{eventId:"<",token:"@",maxTickets:"<"},controller:n,templateUrl:$.spiritec.componentTemplateUrl("limitedCheatLinkBookingInfo/limitedCheatLinkBookingInfo.html")});n.$inject=["webshopApi","$window","scrollService"]}(),function(){angular.module("elbphilharmonie").directive("match",["$parse",function(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r&&(r.$validators.emailmatch=function(n){return i.match===n})}}}])}(),function(){angular.module("elbphilharmonie").directive("birthday",["dateUtils",function(n){return{restrict:"A",require:"ngModel",link:function(t,i,r,u){u&&(u.$validators.birthday=function(t){if(t==null)return!0;if(t instanceof n.DateError)return!1;var i=t;return(typeof t=="string"&&(i=n.parseISODate(t)),!i||typeof i.getMonth!="function")?!1:i<new Date})}}}])}(),function(){angular.module("elbphilharmonie").directive("dateInput",["dateUtils",function(n){return{restrict:"A",require:"ngModel",link:function(t,i,r,u){u&&(u.$parsers.push(function(t){return t?n.germanDatePattern.test(t)?n.parseGermanDate(t):new n.DateError:null}),u.$formatters.push(function(t){return isNaN(t)?null:t instanceof Date?n.formatAsGermanLocalDate(t):""}))}}}])}(),function(){angular.module("elbphilharmonie").directive("greaterThanZero",function(){var n=/^[1-9][0-9]*$/;return{restrict:"A",require:"ngModel",link:function(t,i,r,u){u&&(u.$validators.greaterThanZero=function(t){return n.test(t)})}}})}(),function(){angular.module("elbphilharmonie").directive("notSoldOut",function(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){return r.$setValidity("notSoldOut",n&&!n.soldOut),n});r.$formatters.unshift(function(n){return r.$setValidity("notSoldOut",n&&!n.soldOut),n})}}})}(),function(){angular.module("elbphilharmonie").directive("validateemail",["webshopApi","$timeout",function(n,t){var i=/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i;return{restrict:"A",require:"ngModel",link:function(r,u,f,e){e&&e.$validators.email&&(e.$validators.email=function(r){var u=e.$isEmpty(r)||i.test(r);return e.$isEmpty(r)?(e.blacklist=null,e.domainValid=!1):u&&(typeof e.custTimeout!="undefined"&&t.cancel(e.custTimeout),e.custTimeout=t(function(){n.checkEmail(r).then(function(n){e.blacklist=n.blacklist;e.domainValid=n.domainValid;e.$setValidity("email",!n.blacklist.blocked&&n.domainValid)})},1e3)),u})}}}])}(),function(){function n(n,t){return function(i){var r=i;return(typeof i!="string"||i===""||isNaN(Date.parse(i))||(r=n.parseISODate(i)),!(r instanceof Date))?"":t.getLanguageToken()==="en"?n.formatAsEnglishDayOfWeekAndDate(r):n.formatAsGermanDayOfWeekAndDate(r)}}angular.module("elbphilharmonie").filter("dayOfWeekAndDate",n);n.$inject=["dateUtils","appParameters"]}(),function(){function n(n){function t(n,i){return n.length>=i?n:t("0"+n,i)}return function(i){var r;typeof i=="string"&&(r=new RegExp("[^,]{1,}[,][^.]{1,}","i"),i.match(r)!=null&&(i=i.replace(".","").replace(",",".")),i=parseFloat(i));var u=i%100,e=(i-u)/100,f=e.toString();return f+=n.getLanguageToken()==="en"?".":",",f+t(Math.abs(u).toString(),2)+" €"}}angular.module("elbphilharmonie").filter("euroAmount",n);n.$inject=["appParameters"]}(),function(){function n(){return function(n){var i="",t,r;if(typeof n=="string")for(t=0,r=n.length;t<r;t++)t%4==0&&(i+=" "),i+=n[t];return i}}angular.module("elbphilharmonie").filter("voucherCode",n);n.$inject=[]}(),function(){function n(n){return function(t,i){return(typeof t!="string"||t===""||isNaN(Date.parse(t))||(t=n.parseISODate(t)),!(t instanceof Date))?"":n.formatAsIsoDate(t,i)}}angular.module("elbphilharmonie").filter("localIsoDate",n);n.$inject=["dateUtils","appParameters"]}(),function(){function n(n,t){function i(n,t){return n.length>=t?n:i("0"+n,t)}return function(r){var u=r;if(typeof r!="string"||r===""||isNaN(Date.parse(r))||(u=n.parseISODate(r)),!(u instanceof Date))return"";var f=t.getLanguageToken()==="en"?n.formatAsEnglishLocalDate(u):n.formatAsGermanLocalDate(u),e=i(u.getHours().toString(),2)+":"+i(u.getMinutes().toString(),2),o=t.getLanguageToken()==="en"?"":" Uhr";return f+" "+e+o}}angular.module("elbphilharmonie").filter("localDateWithTime",n);n.$inject=["dateUtils","appParameters"]}(),function(){function n(n,t){return function(i){if(typeof i!="string"||i===""||isNaN(Date.parse(i))||(i=n.parseISODate(i)),!(i instanceof Date))return"";return t.getLanguageToken()==="en"?n.formatAsEnglishLocalDate(i):n.formatAsGermanLocalDate(i)}}angular.module("elbphilharmonie").filter("localDate",n);n.$inject=["dateUtils","appParameters"]}(),function(){function n(n,t){function i(n,t){return n.length>=t?n:i("0"+n,t)}return function(r){var u=r,f,e;return(typeof r!="string"||r===""||isNaN(Date.parse(r))||(u=n.parseISODate(r)),!(u instanceof Date))?"":(f=i(u.getHours().toString(),2)+":"+i(u.getMinutes().toString(),2),e=t.getLanguageToken()==="en"?"":" Uhr",f+e)}}angular.module("elbphilharmonie").filter("localTime",n);n.$inject=["dateUtils","appParameters"]}(),function(){function n(){return function(n){return typeof n!="string"?n:n.replace(/(?:\r\n|\r|\n)/g,"<br />")}}angular.module("elbphilharmonie").filter("nl2br",n);n.$inject=[]}(),function(){angular.module("elbphilharmonie").value("HTMLIZE_CONVERSIONS",[{expr:/\n+?/g,value:"<br>"}]).filter("recognizeLineBreaks",function(n){return function(t){return n.reduce(function(n,t){return n.replace(t.expr,t.value)},t||"")}})}(),function(){angular.module("elbphilharmonie").filter("timeslotHasValues",function(){return function(n){if(!angular.isArray(n))return n;var t=[];return angular.forEach(n,function(n){n.amount>0&&t.push(n)}),t}})}(),function(){function n(){var n=this;n.get=function(){return elbphilharmonie.GetActivityId()};n.set=function(n){elbphilharmonie.SetActivityId(n)}}angular.module("elbphilharmonie").service("activityId",n);n.$inject=[]}(),function(){function n(n,t,i){var r=this,u=n.getActivityServiceBaseUrl();r.validateActivityId=function(n){var r=t.get(u+"validateactivityid.json",{params:{ActivityId:n}});return i.withMicroserviceErrors(r)};r.getNewActivityId=function(){var r=t.get(u+"newactivityid.json",{params:{LanguageToken:n.getLanguageToken()}});return i.withMicroserviceErrors(r)}}angular.module("elbphilharmonie").service("activityService",n);n.$inject=["appParameters","$http","httpHelper","activityId"]}(),function(){function n(){var n=this,t=$.spiritec.appParameters,i=$.spiritec.subscriptionAppParameters,r=$.spiritec.eventAppParameters;n.getWebshopApiBaseUrl=function(){return t.apiBaseUrl};n.getActivityServiceBaseUrl=function(){return t.webserviceUrls.activitiesServiceUrl};n.getAuthenticationServiceBaseUrl=function(){return t.webserviceUrls.authenticationServiceUrl};n.getLoggingServiceBaseUrl=function(){return t.webserviceUrls.loggingServiceUrl};n.getLanguageToken=function(){return t.languageToken};n.getCountryOptions=function(){return t.countryOptions};n.getEMailRepetition=function(){return t.emailRepetition};n.getAcademicTitles=function(){return t.academicTitles};n.getPostalCodeRegEx=function(){return t.postalCodeRegEx};n.isMobile=function(){return t.mobile};n.getSubscription=function(){return i.subscription};n.getEvent=function(){return r.event};n.getReturnPath=function(n){return typeof n!="undefined"&&n==="event"?r.returnPath:i.returnPath};n.getReturnPathLabel=function(n){return n==="event"?r.returnPathLabel:i.returnPathLabel};n.getFileBaseUrl=function(){return t.fileBaseUrl};n.getResetPasswortUrl=function(){return t.resetPasswortUrl};n.getFacebookAppId=function(){return t.facebookAppId};n.getCaptchaSiteKey=function(){return t.captchaSiteKey};n.getCaptchaSecret=function(){return t.captchaSecret};n.getAmazonPayMerchantId=function(){return t.amazonPay.merchantId};n.getAmazonPayClientId=function(){return t.amazonPay.clientId};n.getAmazonUseSandbox=function(){return t.amazonPay.useSandbox}}angular.module("elbphilharmonie").service("appParameters",n)}(),function(){function n(n,t){var i=this,r=n.getAuthenticationServiceBaseUrl();i.createUser=function(n,i){var u=t.postUrlEncoded(r+"createuser.json",{Email:n,Password:i});return t.withMicroserviceErrors(u)};i.login=function(n,i,u){var f=t.postUrlEncoded(r+"login.json",{ActivityId:u,Loginname:n,Password:i});return t.withMicroserviceErrors(f)};i.createUserViaFacebook=function(n){var i=t.postUrlEncoded(r+"createuserviafacebook.json",{AccessToken:n});return t.withMicroserviceErrors(i)};i.loginViaFacebook=function(n,i){var u=t.postUrlEncoded(r+"loginviafacebook.json",{AccessToken:n,ActivityId:i});return t.withMicroserviceErrors(u)};i.changePassword=function(n,i){var u=t.postUrlEncoded(r+"changepassword.json",{ActivityId:i,Password:n});return t.withMicroserviceErrors(u)}}angular.module("elbphilharmonie").service("authenticationService",n);n.$inject=["appParameters","httpHelper"]}(),function(){function n(n,t,i){function u(t){return t().catch(function(r){return r.errorCode===200003?(n.set(r.newActivityId),t()):i.reject(r)})}var r=this;r.synchronizeCart=function(){return u(function(){return t.synchronizeCart(n.get())}).finally(function(){elbphilharmonie.WebshopApi.TriggerCartUpdate()})};r.loadCart=function(){return u(function(){return t.getCart(n.get())})};r.removeCartItem=function(i){return u(function(){return t.removeCartItem(n.get(),i)}).finally(function(){elbphilharmonie.WebshopApi.TriggerCartUpdate()})};r.acceptUpgrade=function(){return u(function(){return t.acceptCartUpgrade(n.get())}).finally(function(){elbphilharmonie.WebshopApi.TriggerCartUpdate()})};r.getAvailableReductions=function(i){return u(function(){return t.getAvailableReductions(n.get(),i)})};r.updateReduction=function(i,r){return u(function(){return t.updateReduction(n.get(),i,r)}).finally(function(){elbphilharmonie.WebshopApi.TriggerCartUpdate()})};r.releaseCart=function(n){return t.releaseCart(n)};r.redeemPromotionCode=function(i){return t.redeemPromotionCode(n.get(),i)}}angular.module("elbphilharmonie").service("cartService",n);n.$inject=["activityId","webshopApi","$q"]}(),function(){function n(n,t,i){function u(t){return t().catch(function(r){return r.errorCode===200003?(n.set(r.newActivityId),t()):i.reject(r)})}var r=this;r.startPayment=function(i,r){return t.startPayment(n.get(),i,r)};r.getShippingMethods=function(){return u(function(){return t.getShippingMethods(n.get())})};r.setShippingMethod=function(i,r){return u(function(){return t.setShippingMethod(n.get(),i.id,r)})};r.setShippingMethodForCartItem=function(i,r){return u(function(){return t.setShippingMethodForCartItem(n.get(),i.id,r.id)})};r.getPaymentMethods=function(){return u(function(){return t.getPaymentMethods(n.get())})};r.setPaymentMethod=function(i){return u(function(){return t.setPaymentMethod(n.get(),i.id)})};r.getReservationCheckoutBookingInfo=function(i,r){return u(function(){return t.getReservationCheckoutBookingInfo(n.get(),i,r)})};r.convertReservation=function(i,r,f){return u(function(){return t.convertReservation(n.get(),i,r,f)})};r.saveCartItemSeatOwner=function(i,r){return u(function(){return t.saveCartItemSeatOwner(n.get(),i,r)})}}angular.module("elbphilharmonie").service("checkoutService",n);n.$inject=["activityId","webshopApi","$q"]}(),function(){function n(n,t,i,r,u,f){function h(){return u.getNewActivityId().then(function(n){return t.set(n.ActivityId),t.get()})}function o(){return u.validateActivityId(t.get()).catch(function(i){return i.errorCode===100004||i.errorCode===100010?h().then(function(){return u.validateActivityId(t.get())}):i.errorCode===200003?(t.set(i.responseData.NewActivityId),u.validateActivityId(t.get())):n.reject(i)}).then(function(n){return n.NewActivityId&&t.set(n.NewActivityId),n})}function c(i,u){return r.login(i,u,t.get()).catch(function(f){return f.errorCode===100004?h().then(function(){return r.login(i,u,t.get())}):f.errorCode===200003?o().then(function(){return r.login(i,u,t.get())}):n.reject(f)})}function s(n,i){return c(n,i).then(function(n){t.set(n.ActivityId)})}var e=this;e.getCustomer=function(n){return o().then(function(t){return t.User?e.loadCustomerData(n):null})};e.getCustomerDataByCheckoutToken=function(t,r){return i.getCustomerDataByCheckoutToken(t,r).catch(function(t){return n.reject(t)}).then(function(n){return n})};e.getLanguage=function(){return o().then(function(n){return n.LanguageToken})};e.getPlazaPartnerAccounts=function(){return i.getPlazaPartnerAccounts(null).catch(function(){return[]})};e.loadCustomerData=function(r){return i.getCustomerData(t.get()).catch(function(r){return r.errorCode===200003?(t.set(r.newActivityId),i.getCustomerData(t.get())):n.reject(r)}).then(function(t){return r&&t.type==="corporation"?n.reject({errorCode:200004,errorDescription:"A non-corporate customer was required but corporate customer was returned.",responseData:{}}):t})};e.login=function(n,t,i){return s(n,t).then(function(){return e.loadCustomerData(i)}).finally(function(){elbphilharmonie.WebshopApi.TriggerLoginStatusUpdate()})};e.register=function(n,t){return n.birthday=f.convertDateToStringForService(n.birthday),i.register(n,t).then(function(){return s(n.email,n.password)}).then(function(){return e.loadCustomerData()}).finally(function(){elbphilharmonie.WebshopApi.TriggerLoginStatusUpdate()})};e.registerAtReservationCheckout=function(n,r,u,o){return u.birthday=f.convertDateToStringForService(u.birthday),i.registerAtReservationCheckout(t.get(),n,r,u,o).then(function(){return s(u.email,u.password)}).then(function(){return e.loadCustomerData()}).finally(function(){elbphilharmonie.WebshopApi.TriggerLoginStatusUpdate()})};e.loginViaFacebook=function(i){return r.loginViaFacebook(i,t.get()).catch(function(u){return u.errorCode===200012?r.createUserViaFacebook(i).then(function(){return r.loginViaFacebook(i,t.get())}):n.reject(u)}).then(function(n){t.set(n.ActivityId)}).then(function(){return e.loadCustomerData()}).finally(function(){elbphilharmonie.WebshopApi.TriggerLoginStatusUpdate()})};e.updateCustomerData=function(n,r){return n.birthday=f.convertDateToStringForService(n.birthday),i.updateCustomerData(t.get(),n,r).finally(function(){elbphilharmonie.WebshopApi.TriggerLoginStatusUpdate()})};e.setAlternativeShippingAddress=function(n){return i.setAlternativeShippingAddress(t.get(),n)};e.changePassword=function(n){return r.changePassword(n,t.get())};e.changeEmail=function(n){return i.changeEmail(t.get(),n)};e.disableAccount=function(n,r,u){return i.disableAccount(t.get(),n,r,u)};e.cancelDisableAccount=function(n,r){return i.cancelDisableAccount(t.get(),n,r)}}angular.module("elbphilharmonie").service("customerService",n);n.$inject=["$q","activityId","webshopApi","authenticationService","activityService","dateUtils"]}(),function(){function n(){function i(n,t,i){return parseInt(n.substring(t,t+i),10)}function t(n,i){return n.length<i?"0"+t(n,i-1):n}function r(n){if(!n||n<1||n>12)return"";return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n-1]}function u(n){if(!n||n<1||n>7)return"";return["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"][n-1]}function f(n){if(!n||n<1||n>7)return"";return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n-1]}var n=this;n.germanDatePattern=/^\s*([1-9]|0[1-9]|[12][0-9]|3[01])[\.]([1-9]|0[1-9]|1[012])[\.](19|20)\d\d\s*$/;n.transformTimeZone=function(n){var t=parseInt($.spiritec.appParameters.utcOffsetInHours)*60;return new Date(n.getTime()+((new Date).getTimezoneOffset()+t)*6e4)};n.isClientInServerTimeZone=function(){var n=parseInt($.spiritec.appParameters.utcOffsetInHours)*60;return n+(new Date).getTimezoneOffset()===0};n.parseGermanDate=function(n){n=n.trim().split(".");var t=parseInt(n[0],10),i=parseInt(n[1]),r=parseInt(n[2],10);return new Date(r,i-1,t)};n.parseISODate=function(n){var t=i(n,0,4),r=i(n,5,2),u=i(n,8,2),f=i(n,11,2),e=i(n,14,2),o=i(n,17,2),s=i(n,20,3);return new Date(t,r-1,u,f,e,o,s)};n.parseUtcISODate=function(n){var t=i(n,0,4),r=i(n,5,2),u=i(n,8,2),f=i(n,11,2),e=i(n,14,2),o=i(n,17,2),s=i(n,20,3);return new Date(Date.UTC(t,r-1,u,f,e,o,s))};n.formatAsIsoDate=function(n,i){var r=Math.floor(i/60),u=i%60;return n.getFullYear()+"-"+t((n.getMonth()+1).toString(),2)+"-"+t(n.getDate().toString(),2)+"T"+t(n.getHours().toString(),2)+":"+t(n.getMinutes().toString(),2)+":"+t(n.getSeconds().toString(),2)+"+"+t(r.toString(),2)+":"+t(u.toString(),2)};n.convertDateToStringForService=function(n){return(n instanceof Date)?n.getFullYear()+"-"+t((n.getMonth()+1).toString(),2)+"-"+t(n.getDate().toString(),2)+"T00:00:00.000":null};n.convertDateTimeToStringForService=function(n){return(n instanceof Date)?n.getFullYear()+"-"+t((n.getMonth()+1).toString(),2)+"-"+t(n.getDate().toString(),2)+"T"+t(n.getHours().toString(),2)+":"+t(n.getMinutes().toString(),2)+":"+t(n.getSeconds().toString(),2)+".000":null};n.formatAsGermanDate=function(n){return n.getUTCDate().toString()+"."+(n.getUTCMonth()+1).toString()+"."+n.getUTCFullYear()};n.formatAsGermanLocalDate=function(n){return n.getDate().toString()+"."+(n.getMonth()+1).toString()+"."+n.getFullYear()};n.formatAsEnglishLocalDate=function(n){return n.getDate().toString()+" "+r(n.getMonth()+1)+" "+n.getFullYear()};n.formatAsGermanDayOfWeekAndDate=function(n){return u(n.getDay()+1)+", "+n.getDate().toString()+"."+(n.getMonth()+1).toString()+"."+n.getFullYear()};n.formatAsEnglishDayOfWeekAndDate=function(n){return f(n.getDay()+1)+", "+n.getDate().toString()+" "+r(n.getMonth()+1)+" "+n.getFullYear()};n.DateError=function(){};n.equalsDateWithOffset=function(n,t){if(!(n instanceof Date))return"";typeof t=="undefined"&&(t=0);var i=new Date;return i.setDate(i.getDate()+t),i.getFullYear()===n.getFullYear()&&i.getMonth()===n.getMonth()&&i.getDate()===n.getDate()};n.equalsDate=function(n,t){return(n instanceof Date)?(t instanceof Date)?n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate():"":""};n.equalsDateTime=function(n,t){return(n instanceof Date)?(t instanceof Date)?n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()&&n.getHours()===t.getHours()&&n.getMinutes()===t.getMinutes()&&n.getSeconds()===t.getSeconds():"":""};n.equalsTime=function(n,t){return(n instanceof Date)?(t instanceof Date)?n.getHours()===t.getHours()&&n.getMinutes()===t.getMinutes()&&n.getSeconds()===t.getSeconds():"":""};n.getDateFromToday=function(n){typeof n=="undefined"&&(n=0);var t=new Date;return t.setDate(t.getDate()+n),t}}angular.module("elbphilharmonie").service("dateUtils",n)}(),function(){function n(n,t,i){var r=this;r.setGuestEmailAddress=function(n){return console.log("ActivityId: "+t.get()),i.setGuestEmailAddress(t.get(),n)}}angular.module("elbphilharmonie").service("guestRegistrationService",n);n.$inject=["$q","activityId","webshopApi"]}(),function(){function n(n,t,i){function u(n){function i(){return n.Errors&&n.Errors.length>0?n.Errors[0]:null}if(n.ResultCode===0||n.ResultCode===1)return null;var t=i();return{errorCode:t?t.ErrorCode:0,errorDescription:t?t.ErrorDescription:"An unknown error occurred",responseData:n}}var r=this;r.postUrlEncoded=function(i,r){return n({method:"POST",url:i,data:t(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}})};r.withMicroserviceErrors=function(n){return n.then(function(n){var t=u(n.data);return t?i.reject(t):n.data})}}angular.module("elbphilharmonie").service("httpHelper",n);n.$inject=["$http","$httpParamSerializerJQLike","$q"]}(),function(){function n(n,t,i){function f(n,t,r,u){return{System:"Client",Severity:n,ActivityId:i.get(),LogType:t,Message:r,Timestamp:u}}var r=this,u=n.getLoggingServiceBaseUrl(),e=0,o=1,s=2;r.logInfo=function(n,t,i){return $.post(u+"logmessage.json",f(e,n,t,i))};r.logWarning=function(n,t,i){return $.post(u+"logmessage.json",f(o,n,t,i))};r.logError=function(n,t,i){return $.post(u+"logmessage.json",f(s,n,t,i))}}angular.module("elbphilharmonie").service("loggingService",n);n.$inject=["appParameters","$http","activityId"]}(),function(){function n(n,t,i){var r=this;r.canSubscribeToNewsletter=function(n){return i.canSubscribeToNewsletter(t.get(),n)};r.getPossibleDistributionLists=function(n){return i.getPossibleDistributionLists(n,t.get())};r.resendNewsletterVerificationMail=function(){return i.resendNewsletterVerificationMail(t.get())};r.saveNewsletterRegistrations=function(n){return i.saveNewsletterRegistrations(t.get(),n)};r.resendOptIn=function(){return i.resendOptIn(t.get())}}angular.module("elbphilharmonie").service("newsletterService",n);n.$inject=["$q","activityId","webshopApi"]}(),function(){function n(n,t){var i=this;i.getBookingConfirmation=function(i,r,u){return t.getBookingConfirmation(n.get(),i,r,u)};i.getCustomerOrderInfos=function(){return t.getCustomerOrderInfos(n.get())};i.getCustomerOrder=function(i){return t.getCustomerOrder(n.get(),i)};i.getCustomerSubscriptions=function(){return t.getCustomerSubscriptions(n.get())};i.saveOrderItemSeatOwner=function(i,r){return t.saveOrderItemSeatOwner(n.get(),i,r)};i.processSeatSponsorship=function(i,r,u){return t.processSeatSponsorship(n.get(),i,r,u)}}angular.module("elbphilharmonie").service("orderService",n);n.$inject=["activityId","webshopApi"]}(),function(){function n(n,t){var i=this;i.commitCreditCardPayment=function(i,r,u){return t.commitCreditCardPayment(n.get(),i,r,u)};i.handleCreditCardInitalisationError=function(i){return t.handleCreditCardInitalisationError(n.get(),i)};i.setAmazonPayOrderReferenceId=function(i,r){return t.setAmazonPayOrderReferenceId(n.get(),i,r)};i.getAmazonPayOrderReferenceId=function(i){return t.getAmazonPayOrderReferenceId(n.get(),i)};i.cancelAmazonPayment=function(i,r){return t.cancelAmazonPayment(n.get(),i,r)};i.prepareAmazonPayScaConfirmationFlow=function(i,r,u){return t.prepareAmazonPayScaConfirmationFlow(n.get(),i,r,u)}}angular.module("elbphilharmonie").service("paymentService",n);n.$inject=["activityId","webshopApi"]}(),function(){function n(){function t(n){console.log("scrollToContent('"+n+"');");$("html, body").animate({scrollTop:$(n).offset().top-100+"px"},"slow")}var n=this;n.scrollToContent=function(n){window.setTimeout(function(){t(n)},250)}}angular.module("elbphilharmonie").service("scrollService",n);n.$inject=["appParameters"]}(),function(){function n(){var n=this;n.IdCounter=0;n.getId=function(){return"ep-unique-id-"+ ++n.IdCounter}}angular.module("elbphilharmonie").service("uniqueIdService",n)}(),function(){function n(n,t,i,r){var u=this;u.saveSubscriptionOrder=function(u,f,e){return n.post(r.getWebshopApiBaseUrl()+"saveSubscriptionOrder.json",{activityId:i.get(),language:r.getLanguageToken(),subscriptionOrder:{subscription:f,customer:u,seatOwners:e.seatOwners,priceCategory:e.priceCategory,contactInfo:e.contactInfo,seatSelectionCriteria:e.seatSelectionCriteria,subscribeToNewsletter:e.subscribeToNewsletter}}).then(function(n){return n.data}).catch(function(n){return t.reject({httpStatus:n.status,errorDescription:n.data.errorDescription})})};u.getSubscriptionGtcInfos=function(u){return n.post(r.getWebshopApiBaseUrl()+"getSubscriptionGtcInfos.json",{activityId:i.get(),language:r.getLanguageToken(),subscription:u}).then(function(n){return n.data}).catch(function(n){return t.reject({httpStatus:n.status,errorDescription:n.data.errorDescription})})};u.ensureSubscriptionOrderHold=function(t,i,u){return n.post(r.getWebshopApiBaseUrl()+"ensureSubscriptionOrderHold.json",{subscriptionId:t,categoryId:i,count:u}).then(function(n){return n.data.success})}}angular.module("elbphilharmonie").service("subscriptionOrderService",n);n.$inject=["$http","$q","activityId","appParameters"]}(),function(){function n(n,t){var i=this;i.waitingArea=function(i){return t.waitingArea(n.get(),i)};i.waitingAreaAccessRegistration=function(i){return t.waitingAreaAccessRegistration(n.get(),i)}}angular.module("elbphilharmonie").service("waitingAreaService",n);n.$inject=["activityId","webshopApi"]}(),function(){function n(n,t,i,r){function v(n){return n.dateAndTime=n.dateAndTime?r.parseISODate(n.dateAndTime):undefined,n}function y(n){n.dateAndTime=n.dateAndTime?r.parseISODate(n.dateAndTime):undefined}function p(n){return{id:n.Id,items:n.Items.map(function(n){return h(n)}),groupedItems:n.GroupedItems.map(function(n){return w(n)}),eventOrganizers:n.EventOrganizers.map(function(n){return b(n)}),jetTicketUpgradePossible:n.JetTicketUpgradePossible,upgradeInfos:n.UpgradeInfos.map(function(n){return d(n)}),defaultShippingMethod:n.DefaultShippingMethod,shippingMethodsWithCosts:n.ShippingMethodsWithCosts,paymentMethod:n.PaymentMethod,totalPrice:n.TotalPrice,totalPriceWithoutFees:n.TotalPriceWithoutFees,useAlternativeShippingAddress:n.UseAlternativeShippingAddress,isLocked:n.IsLocked,isReadonly:n.IsReadonly,isValid:n.IsValid,transactionId:n.TransactionId,voucherItems:n.VoucherItems.map(function(n){return k(n)}),totalPriceAfterVoucher:n.TotalPriceAfterVoucher,totalPriceAfterVoucherWithoutFees:n.TotalPriceAfterVoucherWithoutFees,newVoucherValue:n.NewVoucherValue,hasSeatSponsorshipItems:n.HasSeatSponsorshipItems,hasOtherItems:n.HasOtherItems}}function w(n){return{name:n.Name,dateAndTime:n.DateAndTime?r.parseISODate(n.DateAndTime):undefined,dateAndTimeUTC:n.DateAndTimeUTC,dateAndTimeUTCOffset:n.DateAndTimeUTCOffset,venueName:n.VenueName,eventOrganizerFootNote:n.EventOrganizerFootNote,eventOrganizer:n.EventOrganizer,eventOrganizerAddress:n.EventOrganizerAddress,eventOrganizerVatId:n.EventOrganizerVatId,groupType:n.GroupType,groupTypeText:n.GroupTypeText,items:n.Items.map(function(n){return h(n)}),totalPrice:n.TotalPrice,totalPriceText:n.TotalPriceText,numberOfItems:n.NumberOfItems}}function b(n){return{eventOrganizerFootNote:n.EventOrganizerFootNote,eventOrganizer:n.EventOrganizer,eventOrganizerAddress:n.EventOrganizerAddress,eventOrganizerVatId:n.EventOrganizerVatId}}function k(n){return{id:n.ItemId,code:n.Code,amount:n.Amount}}function h(n){return{id:n.Identifier,quantity:n.Quantity,name:n.Name,isValid:n.IsValid,totalPrice:n.TotalPrice,unitPrice:n.UnitPrice,itemType:n.ItemType.toLowerCase(),venueName:n.VenueName,sectorName:n.SectorName,dateAndTime:n.DateAndTime?r.parseISODate(n.DateAndTime):undefined,dateAndTimeUTC:n.DateAndTimeUTC,dateAndTimeUTCOffset:n.DateAndTimeUTCOffset,seatName:n.SeatName,seatId:n.SeatId,rowName:n.RowName,reductionName:n.ReductionName,reductionId:n.ReductionId,shippingMethod:n.ShippingMethod,shippingMethods:n.ShippingMethods,barCode:n.Barcode,plaArtDate:n.PlaArtDate,timeSlot:n.Timeslot,ticketType:n.TicketType,editable:n.Editable,removable:n.Removable,systems:n.Systems,seatOwner:n.SeatOwner}}function d(n){return{name:n.Name,description:n.Description}}function f(n,i){return t.get(s+n,{params:i}).then(c).catch(l)}function e(n,i){return t.post(s+n,i).then(c).catch(l)}function c(n){return n.data}function l(n){return i.reject(n.data)}function a(n,t){n[t]&&(n[t]=r.parseISODate(n[t]))}var u=this,s=n.getWebshopApiBaseUrl(),o=null;u.getCustomerOrderInfos=function(n){return f("getCustomerOrderInfos.json",{activityId:n}).then(function(n){return n})};u.getCustomerOrder=function(n,t){return f("getCustomerOrder.json",{activityId:n,orderId:t}).then(function(n){return n})};u.getCustomerSubscriptions=function(n){return f("getCustomerSubscriptions.json",{activityId:n}).then(function(n){return n})};u.saveCartItemSeatOwner=function(n,t,i){return e("saveCartItemSeatOwner.json",{activityId:n,cartItemId:t,seatOwner:i})};u.saveOrderItemSeatOwner=function(n,t,i){return e("saveOrderItemSeatOwner.json",{activityId:n,orderItemId:t,seatOwner:i})};u.register=function(n,t){return e("register.json",{email:n.email,password:n.password,customer:n,phoneNumberMandatory:t}).then(function(n){return n})};u.registerAtReservationCheckout=function(n,t,i,r,u){return e("registerAtReservationCheckout.json",{activityId:n,checkoutId:t,checkoutToken:i,password:r.password,customer:r,phoneNumberMandatory:u}).then(function(n){return n})};u.getCustomerData=function(n){return typeof o=="object"&&o!=null?new Promise(function(n){n(o)}):f("getCustomerData.json",{activityId:n}).then(function(n){return a(n,"birthday"),o=n,n})};u.getCustomerDataByCheckoutToken=function(n,t){if(typeof o=="object"&&o!=null)return new Promise(function(n){n(o)});var i={checkoutId:n,checkoutToken:t};return f("getCustomerDataByCheckoutToken.json",i).then(function(n){return a(n,"birthday"),o=n,n})};u.updateCustomerData=function(n,t,i){return o=null,e("setCustomerData.json",{activityId:n,customer:t,phoneNumberMandatory:i})};u.checkEmail=function(n){return f("checkemail.json",{email:n})};u.setGuestEmailAddress=function(n,t){return e("setGuestEmailAddress.json",{activityId:n,email:t})};u.setAlternativeShippingAddress=function(n,t){return e("setAlternativeShippingAddress.json",{activityId:n,address:t})};u.canSubscribeToNewsletter=function(n,t){return new Promise(function(i){f("canSubscribeToNewsletter.json",{activityId:n,context:t}).then(function(n){i(n&&n.canSubscribeToNewsletter===!0)}).catch(function(){i(!1)})})};u.getCart=function(n){return f("getCart.json",{activityId:n,cacheBuster:(new Date).getTime()}).then(function(n){return p(n)})};u.synchronizeCart=function(n){return f("synchronizeCart.json",{activityId:n,cacheBuster:(new Date).getTime()})};u.acceptCartUpgrade=function(n){return f("acceptCartUpgrade.json",{activityId:n})};u.startPayment=function(n,t,i){return f("startPayment.json",{activityId:n,totalPrice:t,subscribeForNewsletter:i})};u.getShippingMethods=function(n){return f("getShippingMethods.json",{activityId:n})};u.setShippingMethodForCartItem=function(n,t,i){return f("setShippingMethodForCartItem.json",{activityId:n,shippingMethodId:t,cartItemId:i})};u.setShippingMethod=function(n,t,i){return f("setShippingMethod.json",{activityId:n,shippingMethodId:t,useAlternativeAddress:i})};u.getPaymentMethods=function(n){return f("getPaymentMethods.json",{activityId:n})};u.setPaymentMethod=function(n,t){return f("setPaymentMethod.json",{activityId:n,paymentMethodId:t})};u.getAvailableReductions=function(n,t){return f("getAvailableReductions.json",{activityId:n,itemId:t})};u.updateReduction=function(n,t,i){return f("updateReduction.json",{activityId:n,itemId:t,reductionId:i})};u.requestPasswordReset=function(n,t){return f("requestPasswordReset.json",{email:n,language:t})};u.resetPassword=function(n,t,i){return f("resetPassword.json",{resetToken:n,password:t,mode:i})};u.changeEmail=function(n,t){return f("changeEmail.json",{activityId:n,email:t})};u.commitCreditCardPayment=function(n,t,i,r){return e("commitCreditCardPayment.json",{activityId:n,paymentRequestId:t,response:btoa(i),success:r})};u.handleCreditCardInitalisationError=function(n,t){return f("handleCreditCardInitalisationError.json",{activityId:n,response:btoa(t)})};u.setAmazonPayOrderReferenceId=function(n,t,i){return e("setAmazonPayOrderReferenceId.json",{activityId:n,paymentRequestId:t,orderReferenceId:i})};u.getAmazonPayOrderReferenceId=function(n,t){return e("getAmazonPayOrderReferenceId.json",{activityId:n,paymentRequestId:t})};u.cancelAmazonPayment=function(n,t,i){return e("cancelAmazonPayment.json",{activityId:n,paymentRequestId:t,orderReferenceId:i})};u.prepareAmazonPayScaConfirmationFlow=function(n,t,i,r){return e("prepareAmazonPayScaConfirmationFlow.json",{activityId:n,paymentRequestId:t,orderReferenceId:i,accessToken:r})};u.getBookingConfirmation=function(n,t,i,r){return f("getBookingConfirmation.json",{activityId:n,orderId:t,orderToken:i,paymentRequest:r}).then(function(n){return n.tickets&&(n.tickets=n.tickets.map(function(n){return v(n)})),n.insuranceUrls&&(n.insuranceUrl=n.insuranceUrls.map(function(n){return y(n)})),n})};u.processSeatSponsorship=function(n,t,i,r){return f("processSeatSponsorship.json",{activityId:n,orderId:t,orderToken:i,paymentRequest:r})};u.waitingArea=function(n,t){return f("waitingArea.json",{activityId:n,productId:t})};u.waitingAreaAccessRegistration=function(n,t){return f("waitingAreaAccessRegistration.json",{activityId:n,productId:t})};u.addMembershipToCart=function(n,t,i){return f("addMembershipToCart.json",{jtMembershipId:n,jtMembershipCount:t,activityId:i})};u.getGuidedTourGroups=function(n){return e("getGuidedTourGroups.json",{ticketType:n})};u.getPlazaTicketContingentsInfo=function(n,t,i,r,u){return f("getPlazaTicketContingentsInfo.json",{from:n,until:t,ticketType:i,guidedTourGroup:r,dateFilter:u})};u.getPlazaTicketContingents=function(n,t,i){return f("getPlazaTicketContingents.json",{ticketType:n,guidedTourGroup:t,dateFilter:i})};u.getPlazaTicketProducts=function(n,t,i){return f("getPlazaTicketProducts.json",{date:n,ticketType:t,guidedTourGroup:i})};u.getPlazaData=function(n,t){return f("getPlazaData.json",{ticketType:n,guidedTourGroup:t})};u.addPlazaTicketToCart=function(n,t,i,r){return f("addPlazaTicketToCart.json",{article:n,ticketType:t,ticketcount:i,price:r})};u.getPlazaPartnerAccounts=function(n){return f("getPlazaPartnerAccounts.json",{accountId:n})};u.getPlazaPartnerContingents=function(n){return f("getPlazaPartnerContingents.json",{accountId:n})};u.bookPlazaPartnerContingent=function(n,t,i,r,u,e,o){return f("bookPlazaPartnerContingent.json",{activityId:n,accountId:t,date:i,amount:r,customer:u,eventName:e,note:o})};u.getPlazaPartnerBookingConfirmation=function(n,t,i){return f("getPlazaPartnerBookingConfirmation.json",{accountId:n,activityId:t,orderId:i})};u.getPlazaPartnerMyBookings=function(n,t,i,r,u,e,o){return f("getPlazaPartnerMyBookings.json",{accountId:n,from:t,until:i,orderId:r,searchFromDate:u,searchUntilDate:e,searchtext:o})};u.getPlazaPartnerBookingOverview=function(n){return f("getPlazaPartnerBookingOverview.json",{accountId:n})};u.getPlazaPartnerBookingOverviewExport=function(n,t){return f("getPlazaPartnerBookingOverviewExport.json",{accountId:n,year:t})};u.checkAndCorrectTicketTargetDevice=function(n,t,i,r){return f("getOnlineTicket.json",{onlineTicketApiCall:"CheckAndCorrectTicketTargetDevice",ticketNumber:n,ticketToken:t,targetDevice:i,ticketOwner:r})};u.sendOnlineTicket=function(n,t,i,r){return f("getOnlineTicket.json",{onlineTicketApiCall:"SendTicket",ticketNumber:n,ticketToken:t,targetDevice:i,ticketOwner:r})};u.getOnlineTicket=function(n,t,i){return f("getOnlineTicket.json",{onlineTicketApiCall:"GetTicket",ticketNumber:n,ticketToken:t,ticketOwner:i})};u.getArticle=function(n){return f("getArticle.json",{articleId:n})};u.addArticleToCart=function(n,t,i){return f("addArticleToCart.json",{articleId:n,contingentId:t,count:i})};u.setCartArticleQuantity=function(n,t,i){return f("setCartArticleQuantity.json",{cartid:n,cartitemId:t,quantity:i})};u.addVoucherToCart=function(n,t){return f("addVoucherToCart.json",{voucherValue:n,count:t})};u.releaseCart=function(n){return f("releaseCart.json",{cartId:n})};u.redeemVoucher=function(n){return f("redeemVoucher.json",{code:n})};u.removeRedeemVoucher=function(n){return f("removeRedeemVoucher.json",{voucherItemId:n})};u.redeemPromotionCode=function(n,t){return f("addpromotioncode.json",{activityId:n,code:t})};u.getPossibleDistributionLists=function(n,t){return f("newsletter-selfcare.json",{method:n,activityId:t})};u.resendNewsletterVerificationMail=function(n){return f("newsletter-selfcare.json",{method:"ConfirmEMailAddress",activityId:n})};u.saveNewsletterRegistrations=function(n,t){return f("newsletter-selfcare.json",{method:"RegisterDistributionLists",activityId:n,distributionLists:JSON.stringify(t)})};u.resendOptIn=function(n){return f("newsletter-selfcare.json",{method:"SendOptInMail",activityId:n})};u.disableAccount=function(n,t,i,r){return f("disable-account.json",{activityId:n,step:t,token:i,language:r})};u.cancelDisableAccount=function(n,t,i){return f("disable-account.json",{activityId:n,step:2,token:t,language:i})};u.addContactOptIn=function(n,t){return e("addContactOptIn.json",{token:n,confirmationText:t})};u.setCheatLinkAccess=function(n,t){return e("setCheatLinkAccess.json",{eventId:n,token:t})};u.getReservationCheckoutBookingInfo=function(n,t,i){return e("getReservationCheckoutBookingInfo.json",{activityId:n,checkoutId:t,checkoutToken:i})};u.convertReservation=function(n,t,i,r){return e("convertReservation.json",{activityId:n,id:t,token:i,itemType:r})};u.removeCartItem=function(n,t){return f("removeCartItem.json",{activityId:n,itemId:t})}}angular.module("elbphilharmonie").service("webshopApi",n);n.$inject=["appParameters","$http","$q","dateUtils"]}(),function(){function n(n,t,i,r){function f(t,i){return n.post(r.getWebshopApiBaseUrl()+t,i).then(e).catch(o)}function e(n){return n.data}function o(n){return t.reject(n.data)}var u=this;u.saveRaffleRegistration=function(u,f,e,o){return n.post(r.getWebshopApiBaseUrl()+"saveRaffleRegistration.json",{activityId:i.get(),customer:u,subscribeToNewlsetter:f,captchaResponse:e,raffleRegistration:o}).then(function(n){return n.data.success}).catch(function(n){return t.reject({httpStatus:n.status,errorDescription:n.data.errorDescription})})};u.getRaffleRegistrationBookingInfo=function(t,i){return n.post(r.getWebshopApiBaseUrl()+"getRaffleRegistrationBookingInfo.json",{activityId:t,registrationId:i})};u.convertRaffleRegistration=function(t,i,u){return n.post(r.getWebshopApiBaseUrl()+"convertReservation.json",{activityId:t,id:i,itemType:u})};u.getCustomerRaffleRegistrations=function(){return f("getCustomerRaffleRegistrations.json",{activityId:i.get()})};u.cancelRaffleRegistration=function(n){return f("removeRaffleRegistration.json",{activityId:i.get(),registrationId:n})};u.raffleRegistrationBookingReturn=function(n){return f("raffleRegistrationBookingReturn.json",{activityId:i.get(),registrationId:n})};u.sendRaffleRegistrationMail=function(n,t){return f("sendRaffleRegistrationMail.json",{activityId:i.get(),registrationId:n,mailTemplateType:t})}}angular.module("elbphilharmonie").service("raffleRegistrationService",n);n.$inject=["$http","$q","activityId","appParameters"]}(),function(){function n(n,t,i,r){var u=this;u.paymentRequestIdSessionKey="amazonPayPaymentRequestId";u.amazonPaymentSdkReady=!1;u.paymentSelected=!1;u.orderReferenceIdSynced=!1;u.orderReferenceId=undefined;u.merchantId=n.getAmazonPayMerchantId();u.clientId=n.getAmazonPayClientId();u.useSandbox=n.getAmazonUseSandbox();u.language="de-DE";n.getLanguageToken().toLowerCase==="en"&&(u.language="en-EN");u.ensureAmazonPayApi=function(){(function(n,t,i){var r,f=n.getElementsByTagName(t)[0];n.getElementById(i)||(r=n.createElement(t),r.id=i,r.src=u.useSandbox?"https://static-eu.payments-amazon.com/OffAmazonPayments/eur/sandbox/lpa/js/Widgets.js":"https://static-eu.payments-amazon.com/OffAmazonPayments/eur/lpa/js/Widgets.js",r.async="async",f.parentNode.insertBefore(r,f))})(document,"script","amazon-pay-widgets")};u.getUrlParameter=function(n,t){return decodeURIComponent((new RegExp("[?|&|#]"+n+"=([^&]+?)(&|#|;|$)").exec(t)||[,""])[1].replace(/\+/g,"%20"))||null};u.tryGetAccessToken=function(){var n=u.getUrlParameter("access_token",location.hash);return typeof n=="string"&&n.match(/^Atza/)?n:""};u.tryGetAccessTokenAndSetCookie=function(){var n=u.tryGetAccessToken();n!==""&&(document.cookie="amazon_Login_accessToken="+n)};u.handlePaymentSelected=function(){u.paymentSelected=!0;u.checkInitializationState()};u.checkInitializationState=function(){u.orderReferenceIdSynced&&u.paymentSelected&&r.$broadcast("amazonPaySuccessfullyInitialized")};u.addPaymentRequestIdToSession=function(n){sessionStorage.setItem(u.paymentRequestIdSessionKey,n)};u.getPaymentRequestIdFromSession=function(){return sessionStorage.getItem(u.paymentRequestIdSessionKey)};u.removePaymentRequestIdFromSession=function(){sessionStorage.removeItem(u.paymentRequestIdSessionKey)};u.trySetOrderReferenceId=function(n){var t=u.getPaymentRequestIdFromSession();typeof t=="string"&&t!==""&&i.setAmazonPayOrderReferenceId(t,n).then(function(){u.orderReferenceIdSynced=!0}).catch(function(){u.orderReferenceIdSynced=!1}).finally(function(){u.checkInitializationState()})};u.initializeAmazonPayCheckout=function(n,i){return u.addPaymentRequestIdToSession(i),new Promise(function(i,r){window.onAmazonLoginReady=function(){amazon.Login.setClientId(u.clientId);amazon.Login.setUseCookie(!0)};window.onAmazonPaymentsReady=function(){var o,e,f;u.amazonPaymentSdkReady=!0;OffAmazonPayments.Button("loginWithAmazonBotton",u.merchantId,{type:"PwA",color:"DarkGray",size:"medium",language:u.language,authorization:function(){o=amazon.Login.authorize({scope:"payments:widget",popup:!1},n)},onError:function(n){t.logError(1,"Statuscode: 2 - Fehler\r\nFehler beim initialisieren des Amazon Pay Buttons.\r\nFehlercode: "+n.getErrorCode()+" | "+n.getErrorMessage());r({errorCode:n.getErrorCode(),errorMessage:"Amazon login button error: "+n.getErrorCode()+" - "+n.getErrorMessage()})}});e=0;f=function(){if(e++>100){r({errorCode:0,errorMessage:"Amazon login button has not been renderd after 10 seconds!"});return}if($("#loginWithAmazonBotton img").length===0){setTimeout(f,100);return}$("#loginWithAmazonBotton img").click();i()};setTimeout(f,0)};u.ensureAmazonPayApi()})};u.renderWallet=function(n){return new Promise(function(i,r){new OffAmazonPayments.Widgets.Wallet({sellerId:u.merchantId,scope:"payments:widget",amazonOrderReferenceId:n,onOrderReferenceCreate:function(n){u.orderReferenceId=n.getAmazonOrderReferenceId();u.trySetOrderReferenceId(u.orderReferenceId)},onPaymentSelect:function(){u.handlePaymentSelected()},design:{designMode:"responsive"},onError:function(n){t.logError(1,"Statuscode: 2 - Fehler\r\nFehler beim initialisieren des Amazon Wallet Widget.\r\nFehlercode: "+n.getErrorCode()+" | "+n.getErrorMessage());r({errorCode:n.getErrorCode(),errorMessage:"Amazon wallet widget error: "+n.getErrorCode()+" - "+n.getErrorMessage()})}}).bind("amazonWalletWidget");var e=0,f=function(){if(e++>100){r({errorCode:0,errorMessage:"Amazon wallet widget has not been renderd after 10 seconds!"});return}if($("#amazonWalletWidget iframe").length===0){setTimeout(f,100);return}i()};setTimeout(f,0)})};u.initializeAmazonPayWallet=function(){return new Promise(function(n,t){u.tryGetAccessTokenAndSetCookie();window.onAmazonLoginReady=function(){amazon.Login.setClientId(u.clientId);amazon.Login.setUseCookie(!0)};window.onAmazonPaymentsReady=function(){u.amazonPaymentSdkReady=!0;var r=undefined,f=u.getPaymentRequestIdFromSession();i.getAmazonPayOrderReferenceId(f).then(function(n){r=n.orderReferenceId}).finally(function(){u.renderWallet(r).then(function(){n()}).catch(function(){t()})})};u.ensureAmazonPayApi()})};u.logout=function(){return new Promise(function(n,t){if(u.removePaymentRequestIdFromSession(),u.amazonPaymentSdkReady&&typeof amazon.Login.logout=="function"){try{amazon.Login.logout();n()}catch(f){t()}return}var i=function(){n()},r=setTimeout(i,2e3);window.onAmazonPaymentsReady=function(){if(u.amazonPaymentSdkReady=!0,clearTimeout(r),typeof amazon.Login.logout=="function"){try{amazon.Login.logout();n()}catch(i){t()}return}n()};u.ensureAmazonPayApi()})};u.cancel=function(){return new Promise(function(n,t){i.cancelAmazonPayment(u.getPaymentRequestIdFromSession(),u.orderReferenceId).finally(function(){u.logout().then(function(){n()}).catch(function(){t()})})})};u.startConfirmationFlow=function(){var n=u.tryGetAccessToken();return new Promise(function(t,r){OffAmazonPayments.initConfirmationFlow(u.merchantId,u.orderReferenceId,function(t){i.prepareAmazonPayScaConfirmationFlow(u.getPaymentRequestIdFromSession(),u.orderReferenceId,n).then(function(){t.success()}).catch(function(n){t.error();(n.errorCode===200110||n.errorCode===200114||n.errorCode===200115)&&u.renderWallet(u.orderReferenceId);r(n)})})})}}angular.module("elbphilharmonie").service("amazonPayService",n);n.$inject=["appParameters","loggingService","paymentService","$rootScope"]}();$(document).ready(function(){initWebsiteFooter()})